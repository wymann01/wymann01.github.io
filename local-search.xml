<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ã€ç¿»è¯‘ã€‘Supporting Gesture Interaction in Your Appsåœ¨ App ä¸­æ”¯æŒæ‰‹åŠ¿äº’åŠ¨</title>
    <link href="/2023/09/04/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Supporting%20Gesture%20Interaction%20in%20Your%20Apps%E5%9C%A8%20App%20%E4%B8%AD%E6%94%AF%E6%8C%81%E6%89%8B%E5%8A%BF%E4%BA%92%E5%8A%A8/"/>
    <url>/2023/09/04/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Supporting%20Gesture%20Interaction%20in%20Your%20Apps%E5%9C%A8%20App%20%E4%B8%AD%E6%94%AF%E6%8C%81%E6%89%8B%E5%8A%BF%E4%BA%92%E5%8A%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>æ‰‹åŠ¿äº’åŠ¨æ˜¯iOS å¹³å°æœ€ç›´è§‚çš„ç”¨æˆ·ä½“éªŒä¹‹ä¸€ï¼Œä»¥åŠGesture Recognizeræä¾›äº†ç®€å•çš„æ–¹æ³•å»å®ç°å®ƒã€‚iOS å®šä¹‰äº†ä¸€äº›<a href="https://developer.apple.com/design/human-interface-guidelines/ios/user-interaction/gestures/">æ ‡å‡†æ‰‹åŠ¿</a>ï¼ŒåŒæ—¶æä¾›äº†å¯¹åº”çš„Gesture Recognizerã€‚ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰Gesture Recognizeræ¥å¤„ç†éæ ‡å‡†çš„æ‰‹åŠ¿ã€‚æœ¬æ–‡çš„ä»£ç ç¤ºä¾‹å·¥ç¨‹å« piecesï¼ˆç‰‡ï¼‰ï¼Œç”¨æ ‡å‡†çš„Gesture Recognizerï¼Œä¸ºä¸‰ä¸ªå½©è‰² View æ·»åŠ å¹³ç§»ã€ç¼©æ”¾å’Œæ—‹è½¬æ”¯æŒï¼Œä»¥åŠå¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„Gesture Recognizerï¼Œå°† piecesé‡ç½®ä¸ºåˆå§‹çŠ¶æ€ã€‚</p><h1 id="è®¾ç½®ä¸€ä¸ªGesture-Recognizer"><a href="#è®¾ç½®ä¸€ä¸ªGesture-Recognizer" class="headerlink" title="è®¾ç½®ä¸€ä¸ªGesture Recognizer"></a><strong>è®¾ç½®ä¸€ä¸ªGesture Recognizer</strong></h1><p>åˆ›å»ºä¸€ä¸ªGesture Recognizerï¼Œè°ƒç”¨<a href="https://developer.apple.com/documentation/uikit/uiview/1622496-addgesturerecognizer?language=objc"><code>addGestureRecognizer:</code></a>æ·»åŠ åˆ°view ä¸Š</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> resetGestureRecognizer <span class="hljs-operator">=</span> <span class="hljs-type">ResetGestureRecognizer</span>(target: <span class="hljs-keyword">self</span>, action: <span class="hljs-keyword">#selector</span>(resetPieces(<span class="hljs-keyword">_</span>:)))view.addGestureRecognizer(resetGestureRecognizer)</code></pre></div><p>Xcodeä¸­æœ‰UIKit çš„æ ‡å‡†Gesture Recognizerï¼Œå¼€å‘è€…å¯ä»¥åœ¨storyboardä¸­ä½¿ç”¨å®ƒä»¬ã€‚åœ¨storyboardä½¿ç”¨Gesture Recognizerï¼š</p><ol><li>æ‰“å¼€storyboard</li><li>åœ¨ Xcodeçš„ Object Library ä¸­æ‰¾åˆ°Gesture Recognizer</li><li>æ‹–åˆ° View ä¸Š</li></ol><blockquote><p>è¿™ä¹ˆç®€å•ä¹Ÿè¦è¯´ï¼Ÿ</p></blockquote><p>å°±è¿™æ ·ï¼ŒXcodeè‡ªåŠ¨åœ°æŠŠGesture Recognizeræ·»åŠ åˆ°storyboardä¸Šï¼ŒåŒæ—¶æŠŠå®ƒè·Ÿ view è”ç³»èµ·æ¥ã€‚åƒç»™å…¶ä»– UI å…ƒç´ æ·»åŠ  actionä¸€æ ·ï¼Œç»™Gesture Recognizerç”¨åŒæ ·æ–¹æ³•è¿›è¡Œæ·»åŠ ã€‚</p><h1 id="å¤„ç†å¹³ç§»ã€æåˆå’Œæ—‹è½¬æ‰‹åŠ¿"><a href="#å¤„ç†å¹³ç§»ã€æåˆå’Œæ—‹è½¬æ‰‹åŠ¿" class="headerlink" title="å¤„ç†å¹³ç§»ã€æåˆå’Œæ—‹è½¬æ‰‹åŠ¿"></a><strong>å¤„ç†å¹³ç§»ã€æåˆå’Œæ—‹è½¬æ‰‹åŠ¿</strong></h1><p>æœ¬ç¤ºä¾‹ä»£ç ç”¨å¹³ç§» panã€æåˆpinch å’Œæ—‹è½¬æ‰‹åŠ¿ï¼Œæ¥ç§»åŠ¨ã€ç¼©æ”¾å’Œæ—‹è½¬è§†å›¾ã€‚å½“ç”¨æˆ·å¹³ç§»ä¸€ä¸ª View æ—¶ï¼ŒUIKit è§¦å‘ç›¸å…³action å‡½æ•°ï¼Œåœ¨æœ¬ç¤ºä¾‹ä»£ç ä¸­ä¸ºpanPiece(<em>:)ã€‚ä¼ å…¥ä¸€ä¸ªå¸¦æœ‰åç§»é‡ï¼ˆtranslationï¼‰çš„<a href="https://developer.apple.com/documentation/uikit/uipangesturerecognizer?language=objc"><code>UIPanGestureRecognizer</code></a>ç¤ºä¾‹ã€‚panPiece(</em>:)ä¼šè®¡ç®—å’Œç§»åŠ¨ view åˆ°æ–°çš„ä½ç½®ï¼Œç„¶åå°†åç§»é‡æ¸…é›¶ï¼Œä¸‹æ¬¡åç§»é‡çš„å€¼å°±å®Œå…¨æ˜¯ç›¸å¯¹æ–°ä½ç½®çš„å¢é‡ã€‚</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> translation <span class="hljs-operator">=</span> panGestureRecognizer.translation(in: piece.superview)piece.center <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: piece.center.x <span class="hljs-operator">+</span> translation.x, y: piece.center.y <span class="hljs-operator">+</span> translation.y)panGestureRecognizer.setTranslation(.zero, in: piece.superview)</code></pre></div><p>ç±»ä¼¼çš„ï¼Œå½“ç”¨æˆ·æåˆå’Œæ—‹è½¬ä¸€ä¸ª Viewï¼Œæœ¬ç¤ºä¾‹ä»£ç ç”¨UIPinchGestureRecognizerçš„scale å±æ€§ã€UIRotationGestureRecognizerçš„rotationå±æ€§ï¼Œæ¥è®¡ç®—å’Œåº”ç”¨æ–°çš„å˜æ¢ï¼Œç„¶åæ¸…é›¶é‚£äº›å±æ€§ã€‚</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> scale <span class="hljs-operator">=</span> pinchGestureRecognizer.scalepiece.transform <span class="hljs-operator">=</span> piece.transform.scaledBy(x: scale, y: scale)pinchGestureRecognizer.scale <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-comment">// æ¸…ç©º scale å±æ€§ï¼Œé‚£ä¹ˆä¸‹æ¬¡ scale ä½¿ç”¨æ—¶å°±æ˜¯æ­£ç¡®çš„å¢é‡</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs Swift">piece.transform <span class="hljs-operator">=</span> piece.transform.rotated(by: rotationGestureRecognizer.rotation)rotationGestureRecognizer.rotation <span class="hljs-operator">=</span> <span class="hljs-number">0</span> <span class="hljs-comment">// æ¸…ç©º rotation å±æ€§ï¼Œä¸‹æ¬¡ rotation ä½¿ç”¨æ—¶å°±æ˜¯æ­£ç¡®çš„å¢é‡</span></code></pre></div><p>scale å’Œrotationå±æ€§è·Ÿè¿™ä¸ª view.layer.<a href="https://developer.apple.com/documentation/quartzcore/calayer/1410817-anchorpoint?language=objc"><code>anchorPoint</code></a> æœ‰å…³ã€‚</p><blockquote><p>anchorPointï¼šè¾¹ç•Œçš„é”šç‚¹ï¼Œview çš„ä¸­å¿ƒç‚¹ï¼Œæ—‹è½¬å°±æ˜¯å›´ç»•è¿™ä¸ªé”šç‚¹è¿›è¡Œã€‚å¯ä»¥é…ç½®ä¸åŒçš„é”šç‚¹ï¼Œé”šç‚¹ä¸åŒï¼Œæ—‹è½¬çš„æ•ˆæœä¸åŒã€‚é»˜è®¤å€¼æ˜¯(0.5, 0.5) ï¼Œä»£è¡¨è¿™ä¸ª view çš„ layer çš„çŸ©å½¢ bound çš„ä¸­å¿ƒã€‚</p></blockquote><p>ä¸ºäº†åœ¨ç¼©æ”¾å’Œæ—‹è½¬æ—¶æ›´åŠ ç›´è§‚ï¼Œæœ¬ç¤ºä¾‹å°†anchorPointç§»åŠ¨åˆ°æ‰‹åŠ¿çš„ä½ç½®ï¼Œè€Œè¿™é€šå¸¸æ˜¯æ‰‹åŠ¿ä¸­åŒ…å«çš„touch çš„è´¨å¿ƒã€‚</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">adjustAnchor</span>(<span class="hljs-params">for</span> <span class="hljs-params">gestureRecognizer</span>: <span class="hljs-type">UIGestureRecognizer</span>) &#123;    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> piece <span class="hljs-operator">=</span> gestureRecognizer.view, gestureRecognizer.state <span class="hljs-operator">==</span> .began <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">return</span>    &#125;    <span class="hljs-keyword">let</span> locationInPiece <span class="hljs-operator">=</span> gestureRecognizer.location(in: piece)    <span class="hljs-keyword">let</span> locationInSuperview <span class="hljs-operator">=</span> gestureRecognizer.location(in: piece.superview)    <span class="hljs-keyword">let</span> anchorX <span class="hljs-operator">=</span> locationInPiece.x <span class="hljs-operator">/</span> piece.bounds.size.width    <span class="hljs-keyword">let</span> anchorY <span class="hljs-operator">=</span> locationInPiece.y <span class="hljs-operator">/</span> piece.bounds.size.height    piece.layer.anchorPoint <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: anchorX, y: anchorY)    piece.center <span class="hljs-operator">=</span> locationInSuperview&#125;</code></pre></div><h1 id="å…è®¸åŒæ—¶è¯†åˆ«å¤šä¸ªæ‰‹åŠ¿"><a href="#å…è®¸åŒæ—¶è¯†åˆ«å¤šä¸ªæ‰‹åŠ¿" class="headerlink" title="å…è®¸åŒæ—¶è¯†åˆ«å¤šä¸ªæ‰‹åŠ¿"></a><strong>å…è®¸åŒæ—¶è¯†åˆ«å¤šä¸ªæ‰‹åŠ¿</strong></h1><p>ç”¨æˆ·æœ‰æ—¶å€™æƒ³å¤šä¸ªæ‰‹åŠ¿åŒæ—¶å·¥ä½œï¼Œæ¯”å¦‚åŒæ—¶æåˆå’Œæ—‹è½¬ã€‚æœ¬ç¤ºä¾‹é€šè¿‡å®ç°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerdelegate?language=objc"><code>UIGestureRecognizerDelegate</code></a>ä¸­æ–¹æ³•å…è®¸äº†è¿™ç§æ•ˆæœï¼Œä¹Ÿå°±æ˜¯åœ¨shouldRecognizeSimultaneouslyWith å‡½æ•°ä¸­è¿”å› Yesï¼Œå…è®¸åŒæ—¶æ“ä½œã€‚</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">func</span> <span class="hljs-title function_">gestureRecognizer</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">gestureRecognizer</span>: <span class="hljs-type">UIGestureRecognizer</span>,                       <span class="hljs-params">shouldRecognizeSimultaneouslyWith</span> <span class="hljs-params">otherGestureRecognizer</span>: <span class="hljs-type">UIGestureRecognizer</span>) -&gt; <span class="hljs-type">Bool</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>&#125;</code></pre></div><p>ä¸ºäº†è®© delegate æ–¹æ³•ç”Ÿæ•ˆï¼Œæœ¬ç¤ºä¾‹å°†Gesture Recognizerçš„ delegate ç½®ä¸ºselfï¼Œä¹Ÿå°±æ˜¯å®ç°æ–¹æ³•çš„view controller</p><div class="code-wrapper"><pre><code class="hljs Swift">resetGestureRecognizer.delegate <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span></code></pre></div><p>å¯¹äºåœ¨storyboardä¸­çš„Gesture Recognizerï¼Œé€šè¿‡æ‹–æ‹½æ¥è®¾ç½®å®ƒä»¬çš„delegateã€‚</p><p>UIGestureRecognizerDelegate æä¾›äº†æ§åˆ¶ã€Œæ‰‹åŠ¿è¯†åˆ«ã€é¡ºåºçš„æ–¹æ³•ï¼Œæƒ³äº†è§£æ›´å¤šæœ‰å…³æ‰‹åŠ¿è¯†åˆ«é¡ºåºçš„ï¼Œè¯·çœ‹ã€Œä¼˜å…ˆè€ƒè™‘æŸä¸ªæ‰‹åŠ¿<a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/coordinating_multiple_gesture_recognizers/preferring_one_gesture_over_another?language=objc">Preferring one gesture over another</a>.ã€</p><h1 id="åˆ›å»ºè‡ªå®šä¹‰çš„Gesture-Recognizer"><a href="#åˆ›å»ºè‡ªå®šä¹‰çš„Gesture-Recognizer" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰çš„Gesture Recognizer"></a><strong>åˆ›å»ºè‡ªå®šä¹‰çš„Gesture Recognizer</strong></h1><p>æœ¬ç¤ºä¾‹åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„Gesture Recognizerâ€”â€” <code>ResetGestureRecognizer</code>ï¼Œè¯†åˆ«çš„æ˜¯åŒ…å«è‡³å°‘ä¸‰ä¸ªæ°´å¹³è½¬å¼¯çš„æ‰‹åŠ¿ã€‚ç”¨æˆ·å¯ä»¥ç”¨å®ƒæ¥åˆå§‹åŒ–è§†å›¾ã€‚æ€ä¹ˆåšå‘¢ï¼Ÿå°†viewä»åˆå§‹ä½ç½®ä¸ŠæŒªèµ°ï¼Œç„¶åæŠŠä¸€æ ¹æ‰‹æŒ‡æ”¾åˆ°æ²¡æœ‰å½©è‰² view è¦†ç›–çš„åœ°æ–¹ï¼Œå·¦å³æ¥å›åˆ’åŠ¨ï¼Œå¥½åƒåœ¨å±å¹•ä¸Šç”©åŠ¨ä½ çš„æ‰‹æŒ‡ã€‚</p><blockquote><p>å…¶å®æ›´å½¢è±¡çš„è¯´æ³•æ˜¯æ‰‹æŒ‡åœ¨æ°´å¹³æ–¹å‘ä¸ŠæŠ˜è¿”è·‘ã€‚</p></blockquote><p>ä¸ºäº†è¯†åˆ«è¿™ä¸ªæ‰‹åŠ¿ï¼Œæœ¬ç¤ºä¾‹åœ¨<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1620009-touchesbegan"><code>touchesBegan(_:with:)</code></a>æŠ“èµ·åˆæ³•çš„ touchï¼Œåœ¨<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1619996-touchesmoved"><code>touchesMoved(_:with:)</code></a>ä¸­æ”¶é›† touch çš„ä½ç½®ã€‚å½“ç”¨æˆ·æŠ¬èµ·æ‰‹æŒ‡ï¼Œè§¦å‘<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1620005-touchesended"><code>touchesEnded(_:with:)</code></a>ï¼Œæœ¬ç¤ºä¾‹å¼€å§‹æ•°è§¦æ‘¸è·¯å¾„ä¸Šæœ‰å¤šå°‘æ¬¡è½¬å¼¯ï¼Œå¦‚æœè·¯å¾„ä¸Šæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„è½¬å¼¯ï¼Œå°† state è®¾ç½®ä¸º .endedï¼Œè¯†åˆ«å‡ºè¿™ä¸ªæ‰‹åŠ¿æ¥ã€‚</p><div class="code-wrapper"><pre><code class="hljs Swift"><span class="hljs-keyword">let</span> count <span class="hljs-operator">=</span> countHorizontalTurning(touchedPoints: touchedPoints)state <span class="hljs-operator">=</span> count <span class="hljs-operator">&gt;</span> <span class="hljs-number">2</span> <span class="hljs-operator">?</span> .ended : .failed</code></pre></div><p>æ³¨æ„ï¼Œæœ¬ç¤ºä¾‹æ²¡æœ‰è¿›ä¸€æ­¥æ¶ˆé™¤ä½ç½®è¯¯å·®æˆ–è€…æ£€æŸ¥å®ƒä»¬çš„è·ç¦»æ¥éªŒè¯ï¼Œåœ¨çœŸå®ä¸–ç•Œé‡Œï¼Œè¿™äº›æªæ–½æ˜¯è¦è€ƒè™‘æ‰§è¡Œçš„ï¼Œä»è€Œæé«˜è¯†åˆ«ç²¾ç¡®åº¦å’Œé¿å…è¯†åˆ«é”™è¯¯ã€‚</p><p>æ›´å¤šæœ‰å…³è‡ªå®šä¹‰Gesture Recognizerçš„ç»†èŠ‚ï¼Œè¯·è¯»ã€Œå®ç°ä¸€ä¸ªè‡ªå®šä¹‰Gesture Recognizer <a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer">Implementing a custom gesture recognizer</a>. ã€</p><blockquote><p>æ€»ç»“ï¼šä»‹ç»äº†å¦‚ä½•å…è®¸å¤šä¸ªæ‰‹åŠ¿åŒæ—¶å·¥ä½œï¼Œå¦‚ä½•å¤„ç†æ ‡å‡†æ‰‹åŠ¿ã€ä»¥åŠå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰Gesture Recognizerå¤„ç†éæ ‡å‡†æ‰‹åŠ¿ã€‚</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€ç¿»è¯‘ã€‘About the Gesture Recognizer State Machineå…³äºGesture Recognizer çš„çŠ¶æ€æœº</title>
    <link href="/2023/09/03/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91About%20the%20Gesture%20Recognizer%20State%20Machine%E5%85%B3%E4%BA%8EGesture%20Recognizer%20%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA/"/>
    <url>/2023/09/03/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91About%20the%20Gesture%20Recognizer%20State%20Machine%E5%85%B3%E4%BA%8EGesture%20Recognizer%20%E7%9A%84%E7%8A%B6%E6%80%81%E6%9C%BA/</url>
    
    <content type="html"><![CDATA[<p><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer/about_the_gesture_recognizer_state_machine?language=objc">https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer/about_the_gesture_recognizer_state_machine?language=objc</a></p><p>â€”-å­¦ä¹ Gesture Recognizeråº•å±‚çš„state å’Œ state çš„è½¬å˜ã€‚</p><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Gesture Recognizerè¢«çŠ¶æ€æœºé©±åŠ¨ï¼ˆ<strong>state machine</strong>ï¼‰ï¼ŒUIKitä¹Ÿç”¨ ta æ¥ä¿è¯æ­£ç¡®å¤„ç†äº‹ä»¶ã€‚çŠ¶æ€æœºå†³å®šäº†å‡ ä¸ªé‡è¦çš„è¡Œä¸ºï¼š</p><ul><li>Gesture Recognizeræ˜¯å¦è¢«å…è®¸è¿›å…¥<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatebegan?language=objc"><code>UIGestureRecognizerStateBegan</code></a> çŠ¶æ€ã€‚</li><li>Gesture Recognizeræ˜¯å¦è¢«å…è®¸è¿›å…¥<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstateended?language=objc"><code>UIGestureRecognizerStateEnded</code></a>çŠ¶æ€ã€‚ï¼ˆè¿™ä¸ªæ˜¯ endï¼Œä¸Šé¢çš„æ˜¯ beganï¼‰</li><li>ä»€ä¹ˆæ—¶å€™è°ƒç”¨action å‡½æ•°ï¼Ÿ</li></ul><p>è‡ªå®šä¹‰ä¸€ä¸ª Gesture Recognizer æ—¶ï¼Œä½ å¿…é¡»åœ¨åˆé€‚çš„æ—¶å€™æ›´æ–°çŠ¶æ€æœºã€‚ä¸€ä¸ª Gesture Recognizer æ°¸è¿œéƒ½æ˜¯ä»<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatepossible?language=objc"><code>UIGestureRecognizerStatePossible</code></a>å¼€å§‹ï¼Œè¡¨ç¤º taå·²ç»å‡†å¤‡å¥½å¯ä»¥å¤„ç†äº‹ä»¶äº†ã€‚åˆ†ç¦»çš„å’Œè¿ç»­çš„ Gesture Recognizer ä¼šç»è¿‡ä¸åŒçš„è·¯å¾„åˆ°è¾¾<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstateended?language=objc"><code>UIGestureRecognizerStateEnded</code></a>, <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatefailed?language=objc"><code>UIGestureRecognizerStateFailed</code></a>, æˆ–è€…<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatecancelled?language=objc"><code>UIGestureRecognizerStateCancelled</code></a> çŠ¶æ€ï¼ŒGesture Recognizer ä¼šå¾…åœ¨è¿™å‡ ä¸ªçŠ¶æ€ä¹‹ä¸€ï¼ŒçŸ¥é“äº‹ä»¶åºåˆ—ç»“æŸã€‚</p><p>æœ€åï¼ŒUIKit ä¼šé‡ç½®Gesture Recognizer ï¼Œå¹¶è®©å®ƒå›åˆ°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatepossible?language=objc"><code>UIGestureRecognizerStatePossible</code></a>çŠ¶æ€ã€‚</p><h1 id="åˆ†ç¦»çš„Gesture-Recognizer-çš„çŠ¶æ€è½¬å˜"><a href="#åˆ†ç¦»çš„Gesture-Recognizer-çš„çŠ¶æ€è½¬å˜" class="headerlink" title="åˆ†ç¦»çš„Gesture Recognizer çš„çŠ¶æ€è½¬å˜"></a><strong>åˆ†ç¦»çš„Gesture Recognizer çš„çŠ¶æ€è½¬å˜</strong></h1><p>å¯¹äºè‡ªå®šä¹‰çš„ã€åˆ†ç¦»çš„Gesture Recognizer ï¼Œta æœ‰ä¸¤ç§çŠ¶æ€<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstateended?language=objc"><code>UIGestureRecognizerStateEnded</code></a> æˆ– <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatefailed?language=objc"><code>UIGestureRecognizerStateFailed</code></a>ã€‚ä¸‹å›¾å±•ç¤ºäº†å®ƒçš„è½¬å˜è·¯å¾„ã€‚å½“ä¸æ–­åˆ°æ¥çš„äº‹ä»¶åŒ¹é…åˆ°äº†ä½ å†™çš„æ‰‹åŠ¿ï¼Œè¯†åˆ«å™¨ä¼šè½¬åˆ°<code>UIGestureRecognizerStateEnded</code>ï¼Œå½“åŒ¹é…å¤±è´¥æ—¶ï¼Œè½¬åˆ°<code>UIGestureRecognizerStateFailed</code>ã€‚</p><p><img src="https://secure2.wostatic.cn/static/5EGB4JaPaWFc7LK2g9xT3d/image.png?auth_key=1693715005-fAcm71zDWMHZehaSz6iX9j-0-5977b7bfcc3b495a98d185e181d2892c"></p><blockquote><p>å›¾æ–‡ä¼¼ä¹æœ‰ç‚¹ä¸ç¬¦ï¼Œå³ä¾§åœ†åœˆå†…åº”ä¸ºã€ŒEndedã€ã€‚</p></blockquote><p>å½“è½¬åˆ°ç»“æŸçš„çŠ¶æ€æ—¶ï¼ˆ<code>UIGestureRecognizerStateEnded</code>ï¼‰ï¼ŒUIKitä¼šè°ƒç”¨æ‰€æœ‰å…³è”ç›®æ ‡å¯¹è±¡çš„ action å‡½æ•°ã€‚</p><p>å¦‚æœè½¬åˆ°çš„æ˜¯å¤±è´¥çš„çŠ¶æ€ï¼ˆ<code>UIGestureRecognizerStateFailed</code>ï¼‰ï¼Œä¸è°ƒç”¨ä»»ä½•å‡½æ•°ã€‚</p><p>æƒ³äº†è§£å®é™…ä¾‹å­çš„ï¼Œè¯·çœ‹<a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer/implementing_a_discrete_gesture_recognizer?language=objc">ã€Œå®ç°ä¸€ä¸ªåˆ†ç¦»çš„Gesture Recognizer</a>ã€ ã€‚</p><p><strong>è¿ç»­çš„çš„Gesture Recognizer çš„çŠ¶æ€è½¬å˜</strong></p><p>å…ˆçœ‹å›¾</p><p><img src="https://secure2.wostatic.cn/static/xxxm1dG58kaEb4bK7qePmr/image.png?auth_key=1693715005-qoz8EvKnTY2G6cJ6ZJX7E4-0-0b20b66d4721d9c2b37529605dcd9a68"></p><ul><li>åˆå§‹çš„äº‹ä»¶åºåˆ—ä¼šå°†Gesture Recognizer è½¬åˆ°</li></ul><p><a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatebegan?language=objc"><code>UIGestureRecognizerStateBegan</code></a> æˆ– <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatefailed?language=objc"><code>UIGestureRecognizerStateFailed</code></a>çŠ¶æ€</p><ul><li>æ¥ä¸‹æ¥çš„äº‹ä»¶åºåˆ—ä¼šè®© ta è½¬åˆ°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatechanged?language=objc"><code>UIGestureRecognizerStateChanged</code></a> æˆ– <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatecancelled?language=objc"><code>UIGestureRecognizerStateCancelled</code></a></li><li>æœ€åæ˜¯<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstateended?language=objc"><code>UIGestureRecognizerStateEnded</code></a></li></ul><p>å¦‚æœåˆå§‹äº‹ä»¶åºåˆ—ä¸èƒ½åŒ¹é…ä¸Šä½ å†™çš„æ‰‹åŠ¿ï¼Œé‚£Gesture Recognizer ä¼šç›´æ¥ä» possible åˆ° failedã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒUIKit ä¸€æ¬¡åªå…è®¸ä¸€ä¸ªGesture Recognizer é€šçŸ¥ clientï¼ˆä¹Ÿå°±æ˜¯åœ¨å®šä¹‰æ—¶å†™å¥½çš„ targetï¼‰ã€‚ä¸€ä¸ªGesture Recognizer å¤±è´¥äº†ï¼Œå°±ä¼šç»™å…¶ä»–Gesture Recognizer ä¸€æ¬¡å¤„ç†å®ƒä»¬æ‰‹åŠ¿çš„æœºä¼šã€‚</p><p>å¦‚æœåˆå§‹äº‹ä»¶åºåˆ—åŒ¹é…ä¸Šäº†ä½ çš„æ‰‹åŠ¿ï¼ŒGesture Recognizerä¼šè½¬åˆ°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatebegan?language=objc"><code>UIGestureRecognizerStateBegan</code></a>çŠ¶æ€ï¼Œå¯¹äºåç»­çš„äº‹ä»¶ï¼Œä¼šé‡å¤åœ°è½¬åˆ°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatechanged?language=objc"><code>UIGestureRecognizerStateChanged</code></a>çŠ¶æ€ï¼Œè¡¨ç¤ºäº‹ä»¶ä¿¡æ¯å·²ç»æ”¹å˜ï¼ˆå³ä¾¿ state å·²ç»æ˜¯ changed çš„å–å€¼äº†ï¼Œä¹Ÿè¦ä¸æ–­åœ°è®¾ç½® state çŠ¶æ€ï¼Œå› ä¸ºã€Œè®¾ç½® stateã€è¿™ä¸ªåŠ¨ä½œä¼šè§¦å‘å¯¹åº”çš„ action å‡½æ•°ï¼‰ã€‚æœ€åï¼Œå°±æ˜¯æˆåŠŸè¯†åˆ«å°±æŠŠ state ç½®ä¸ºended ï¼Œå¤±è´¥å°±ç½®ä¸ºcancelledã€‚å½“Gesture Recognizerçš„state è¢«ç½®ä¸ºbeganã€changedå’Œended ä¸‰è€…ä¹‹ä¸€æ—¶ï¼ŒUIKitéƒ½ä¼šè°ƒç”¨ action å‡½æ•°ã€‚å¦åˆ™ï¼Œä¸è°ƒç”¨ä»»ä½•å‡½æ•°ã€‚</p><p>è¦äº†è§£å®é™…ä¾‹å­ï¼Œçœ‹ã€Œ<a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer/implementing_a_continuous_gesture_recognizer?language=objc">å®ç°ä¸€ä¸ªè¿ç»­çš„Gesture Recognizer</a>ã€</p><h1 id="å¤„ç†ã€Œå–æ¶ˆæ“ä½œã€"><a href="#å¤„ç†ã€Œå–æ¶ˆæ“ä½œã€" class="headerlink" title="å¤„ç†ã€Œå–æ¶ˆæ“ä½œã€"></a><strong>å¤„ç†ã€Œå–æ¶ˆæ“ä½œã€</strong></h1><p>å½“ã€Œç³»ç»Ÿäº‹ä»¶ã€ä¸­æ–­äº†ã€Œäº‹ä»¶åºåˆ—ã€æ—¶ï¼ˆæ¯”å¦‚æœ‰ç”µè¯æ‰“è¿›æ¥ï¼‰æ‰‹åŠ¿å–æ¶ˆå°±å‘ç”Ÿäº†ã€‚ä¹Ÿå¯ä»¥äº‹ä»¶åºåˆ—ä¸­çš„ä¿¡æ¯æˆ–è€…App ä¸­çš„å…¶ä»–æ¡ä»¶ï¼Œç”¨ä»£ç å–æ¶ˆæ‰‹åŠ¿ã€‚ã€Œå–æ¶ˆã€ä¼šé˜²æ­¢Gesture Recognizeræ‰§è¡ŒæŸäº›ç”¨æˆ·å¹¶ä¸æƒ³åšçš„æ“ä½œã€‚</p><p>å½“ç³»ç»Ÿå–æ¶ˆæ‰‹åŠ¿æ—¶ï¼ŒUIKit ä¼šè°ƒç”¨<a href="https://developer.apple.com/documentation/uikit/uiresponder/1621116-touchescancelled?language=objc"><code>touchesCancelled:withEvent:</code></a> ï¼Œ <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1619999-pressescancelled?language=objc"><code>pressesCancelled:withEvent:</code></a>ã€‚åŒæ—¶ï¼Œé©¬ä¸ŠæŠŠGesture Recognizerçš„ state ç½®ä¸º cancelledï¼ŒUIKit ä¼šè°ƒç”¨ actionå‡½æ•°æœ€åä¸€æ¬¡ã€‚éšå³é‡ç½®ï¼ˆè§ä¸‹ï¼‰ã€‚</p><h1 id="é‡ç½®Gesture-Recognizer-çš„çŠ¶æ€æœº"><a href="#é‡ç½®Gesture-Recognizer-çš„çŠ¶æ€æœº" class="headerlink" title="é‡ç½®Gesture Recognizer çš„çŠ¶æ€æœº"></a><strong>é‡ç½®Gesture Recognizer çš„çŠ¶æ€æœº</strong></h1><p>å®ç°<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1620004-reset?language=objc"><code>reset</code></a>æ–¹æ³•ï¼Œè®©ä½ çš„Gesture Recognizerå›åˆ°åˆå§‹é…ç½®ã€‚ä¾‹å¦‚ï¼Œç”¨è¿™ä¸ªæ–¹æ³•æ¥æŠŠè¯†åˆ«å™¨çš„å±æ€§ç½®ä¸ºåˆå§‹å€¼ï¼Œåœ¨å¤„ç†æ–°çš„äº‹ä»¶åºåˆ—å‰ï¼ŒUIkit ä¼šè°ƒç”¨ç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„Gesture Recognizerçš„<code>reset</code> å‡½æ•°ï¼š</p><ol><li>æ¥æ”¶touch äº‹ä»¶çš„</li><li>å¤„åœ¨failedã€ended å’Œcancelled çŠ¶æ€çš„</li></ol><p>é™¤äº†è°ƒç”¨ <code>reset</code> å‡½æ•°ï¼ŒUIKit ä¼šè‡ªåŠ¨ä¿®æ”¹æ¯ä¸€ä¸ªUIGestureRecognizerStateFailed çš„ state ä¸ºpossible çŠ¶æ€ï¼Œä»¥ä¾¿å®ƒä»¬èƒ½å“åº”æ–°çš„äº‹ä»¶åºåˆ—ã€‚</p><blockquote><p>æ€»ç»“ï¼šä¸åŒç±»å‹çš„Gesture Recognizerçš„çŠ¶æ€æœºè½¬å˜è·¯å¾„æ˜¯ä¸ä¸€æ ·çš„ï¼›æ‰‹åŠ¿å–æ¶ˆä¹Ÿä¼šè°ƒç”¨ ä¸€æ¬¡action å‡½æ•°ï¼›å¤„ç†æ–°çš„äº‹ä»¶åºåˆ—å‰å¯ä»¥é‡ç½®ä¸€ä¸‹Gesture Recognizerã€‚</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€ç¿»è¯‘ã€‘Implementing a custom gesture recognizerå®ç°è‡ªå®šä¹‰çš„æ‰‹åŠ¿è¯†åˆ«å™¨</title>
    <link href="/2023/09/03/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Implementing%20a%20custom%20gesture%20recognizer%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB%E5%99%A8/"/>
    <url>/2023/09/03/%E3%80%90%E7%BF%BB%E8%AF%91%E3%80%91Implementing%20a%20custom%20gesture%20recognizer%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<p>â€”â€”æ¢ç´¢ã€Œä»€ä¹ˆæ—¶å€™ã€ä»¥åŠå¦‚ä½•æ‰“é€ è‡ªå®šä¹‰çš„ Gesture Recognizer ã€‚</p><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>å½“ UIKi å†…ç½®çš„ Gesture Recognizer ä¸èƒ½æ»¡è¶³éœ€æ±‚æ—¶ï¼Œä½ å°±å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªã€‚UIKitåŒ…å«äº†é«˜åº¦å¯é…ç½®çš„ Gesture Recognizer ï¼Œå¯ä»¥å¤„ç†è½»å‡»tapã€é•¿æŒ‰long pressã€æ‹–åŠ¨panã€æ»‘åŠ¨ swipeã€æ—‹è½¬rotationå’Œæåˆpinchçš„ touch åºåˆ—ã€‚</p><p>å¯¹äºå…¶ä»–çš„ touch åºåˆ—ï¼Œæˆ–è€…å¤„ç†æ¶‰åŠæŒ‰ä¸‹æŒ‰é’®çš„æ‰‹åŠ¿ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ª Gesture Recognizer </p><blockquote><p>è¯‘è€…æ³¨ï¼štouchåºåˆ—ï¼ˆtouch sequenceï¼‰ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª UITouchå¯¹è±¡ï¼Œå®ƒä»¬æœ€ç»ˆä¼šç»„æˆä¸€ä¸ª UIEvent å¯¹è±¡ã€‚</p></blockquote><p>ä¹Ÿå¯ä»¥ç”¨è‡ªå®šä¹‰çš„Gesture Recognizer æ¥ç®€åŒ–äº‹ä»¶å¤„ç†ã€‚ä¾‹å¦‚ï¼Œ<a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/leveraging_touch_input_for_drawing_apps?language=objc">Leveraging Touch Input for Drawing Apps</a>è¿™ä¸ªç¤ºä¾‹ä»£ç å°±æ˜¯ç”¨è‡ªå®šä¹‰çš„Gesture Recognizerï¼Œæ¥æ•è·inputå¹¶æŠŠå®ƒå±•ç¤ºåˆ°å±å¹•ä¸Šï¼Œå¦‚å›¾ï¼š</p><p><img src="https://secure2.wostatic.cn/static/h3VbWKZEqgDDPpBsPj7Bqf/image.png?auth_key=1693714189-w5kVniVo2d9tLm3SsTd49h-0-263a178fa8800190d890b282077f380c"></p><p>æƒ³è¦è‡ªå®šä¹‰Gesture Recognizerï¼Œéœ€è¦å…ˆç»§æ‰¿å®ƒã€‚è®°å¾—åœ¨ä½ çš„ä»£ç æ–‡ä»¶å¼€å¤´å¯¼å…¥å¯¹åº”å¤´æ–‡ä»¶ï¼ˆOCï¼šUIGestureRecognizerSubclass.hï¼› Swiftï¼šUIKit.UIGestureRecognizerSubclassï¼‰ã€‚è¿™äº›å¤´æ–‡ä»¶å®šä¹‰äº†ä½ å¿…é¡»é‡å†™çš„æ–¹æ³•ï¼š</p><div class="code-wrapper"><pre><code class="hljs Objective-C">#import &lt;UIKit/UIKit.h&gt;#import &quot;UIGestureRecognizerSubclass.h&quot;</code></pre></div><p>åœ¨ä½ çš„å­ç±»ä¸­ï¼Œå®ç°é‚£äº›å¤„ç†äº‹ä»¶çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ è¦å¤„ç†çš„æ‰‹åŠ¿ç”±touch äº‹ä»¶ç»„æˆï¼Œé‚£å°±å®ç°<a href="https://developer.apple.com/documentation/uikit/uiresponder/1621142-touchesbegan?language=objc"><code>touchesBegan:withEvent:</code></a>, <a href="https://developer.apple.com/documentation/uikit/uiresponder/1621107-touchesmoved?language=objc"><code>touchesMoved:withEvent:</code></a>, <a href="https://developer.apple.com/documentation/uikit/uiresponder/1621084-touchesended?language=objc"><code>touchesEnded:withEvent:</code></a>, å’Œ <a href="https://developer.apple.com/documentation/uikit/uiresponder/1621116-touchescancelled?language=objc"><code>touchesCancelled:withEvent:</code></a> æ–¹æ³•ã€‚ç”¨ä¸æ–­åˆ°æ¥çš„äº‹ä»¶æ›´æ–°ä½ å­ç±»çš„<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1619998-state?language=objc"><code>state</code></a>å±æ€§ã€‚</p><p>UIKitä¼šç”¨è¿™ä¸ª state æ¥åè°ƒäº’åŠ¨ä½  App é‡Œçš„å…¶ä»–å¯¹è±¡ã€‚</p><blockquote><p>æ€»ç»“ï¼šä»€ä¹ˆæ—¶å€™è¯¥è‡ªå®šä¹‰ä¸€ä¸ªGesture Recognizerï¼Ÿå½“ä½ è§‰å¾—ç°æœ‰çš„ä¸å¤Ÿç”¨æ—¶ï¼›å¦‚ä½•è‡ªå®šä¹‰ï¼Ÿå¯¼å…¥å¤´æ–‡ä»¶ï¼Œå®ç°äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚ï¼ˆè€å®è¯´æˆ‘è§‰å¾—è¿™æ–‡ç« æœ‰ç‚¹æ°´ï¼‰</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ã€ç¿»è¯‘ã€‘Handling UIKit gestures å¤„ç† UIkit çš„ gesture</title>
    <link href="/2023/09/03/%5B%E7%BF%BB%E8%AF%91%5DHandling%20UIKit%20gestures%20%E5%A4%84%E7%90%86%20UIkit%20%E7%9A%84%20gesture/"/>
    <url>/2023/09/03/%5B%E7%BF%BB%E8%AF%91%5DHandling%20UIKit%20gestures%20%E5%A4%84%E7%90%86%20UIkit%20%E7%9A%84%20gesture/</url>
    
    <content type="html"><![CDATA[<p>â€”â€”ä½¿ç”¨Gesture  Recognizeræ¥ç®€åŒ–Touchå¤„ç†å’Œæ‰“é€ ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ</p><h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>Gesture  Recognizeræ˜¯å¤„ç†ç‚¹å‡»å’Œé•¿æŒ‰äº‹ä»¶çš„æœ€ç®€å•æ–¹æ³•ï¼Œä½ å¯ä»¥æŠŠä¸€ä¸ªæˆ–è€…å‡ ä¸ªGesture  Recognizeré™„åŠ åˆ°ä»»ä½•viewä¸Šï¼Œå®ƒå°è£…äº†å¤„ç†å’Œè§£é‡Šäº‹ä»¶çš„æ‰€æœ‰é€»è¾‘ï¼Œå¹¶æŠŠå®ƒä»¬åŒ¹é…åˆ°å·²çŸ¥çš„æ¨¡å¼ã€‚å½“æ£€æµ‹åˆ°åŒ¹é…ï¼ŒGesture  Recognizerä¼šé€šçŸ¥ç‰¹å®šå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥æ˜¯view controller, view  æœ¬èº«ï¼Œæˆ–è€…Appä¸­çš„å…¶ä»–å¯¹è±¡ã€‚</p><p>Gesture  Recognizerç”¨ target-actionæ¨¡å¼æ¥å‘é€é€šçŸ¥ã€‚å½“ä¸€ä¸ª </p><p><a href="https://developer.apple.com/documentation/uikit/uitapgesturerecognizer?language=objc"><code>UITapGestureRecognizer</code></a>å¯¹è±¡æ£€æµ‹åˆ°viewä¸­çš„å•æŒ‡ç‚¹å‡»æ—¶ï¼Œå®ƒä¼šè°ƒç”¨è¿™ä¸ª view çš„ view controller é‡Œçš„action å‡½æ•°ã€‚</p><blockquote><p>è¯‘è€…æ³¨ï¼šè¿™é‡Œçš„ action å‡½æ•°æŒ‡åœ¨Gesture  Recognizer åœ¨åˆ›å»ºæ—¶å°±å®šä¹‰å¥½çš„ã€ä¸€æ—¦è§¦å‘å°±å»è°ƒç”¨çš„æ–¹æ³•ã€‚ä¸‹åŒã€‚</p></blockquote><p><img src="https://secure2.wostatic.cn/static/x28vNKMSHe1uCEhoLp7jKF/image.png?auth_key=1693713746-wzAt9jYJhQBVMuQ56nASG1-0-0f4161c6ddfe64e69749b1a48aa44b1d"></p><h1 id="Gesture-recognizer-æœ‰ä¸¤ç§ï¼šç¦»æ•£çš„å’Œè¿ç»­çš„"><a href="#Gesture-recognizer-æœ‰ä¸¤ç§ï¼šç¦»æ•£çš„å’Œè¿ç»­çš„" class="headerlink" title="Gesture recognizer æœ‰ä¸¤ç§ï¼šç¦»æ•£çš„å’Œè¿ç»­çš„"></a>Gesture recognizer æœ‰ä¸¤ç§ï¼š<strong>ç¦»æ•£</strong>çš„å’Œ<strong>è¿ç»­</strong>çš„</h1><p>ç¦»æ•£çš„Gesture recognizeråœ¨æ£€æµ‹åˆ°æ‰‹åŠ¿åä»…ä»…è°ƒç”¨ä¸€æ¬¡action å‡½æ•°ã€‚</p><p>è€Œå¯¹äºè¿ç»­çš„Gesture  Recognizeï¼Œåœ¨ï¼ˆæ‰‹åŠ¿ï¼‰æ»¡è¶³è¯†åˆ«æ ‡å‡†åï¼Œå®ƒä¼šè°ƒç”¨ action æ–¹æ³•å¾ˆå¤šæ¬¡ï¼Œåªè¦æ‰‹åŠ¿äº‹ä»¶é‡Œçš„ä¿¡æ¯æœ‰æ”¹å˜å°±ä¼šé€šçŸ¥ä½ ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ª<a href="https://developer.apple.com/documentation/uikit/uipangesturerecognizer?language=objc"><code>UIPanGestureRecognizer</code></a>å¯¹è±¡ä¼šåœ¨æ¯ä¸€æ¬¡ã€Œè§¦ç¢°ä½ç½®ã€æ”¹å˜æ—¶è°ƒç”¨action å‡½æ•°ã€‚</p><p>Interface Builder åŒ…å«æ¯ä¸€ç§æ ‡å‡†çš„ UIKit Gesture  Recognizerå¯¹è±¡ï¼Œå®ƒè¿˜åŒ…å«äº†è‡ªå®šä¹‰çš„Gesture  Recognizerï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªæ¥ä»£è¡¨ä½ è‡ªå·±çš„Gesture  Recognizerå­ç±»</p><blockquote><p>ååŠå¥æˆ‘ä¹Ÿæ²¡çœ‹æ‡‚ï¼ŒåŸæ–‡å¦‚ä¸‹ï¼š<br>It also includes a custom gesture recognizer object that you can use to represent your custom <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer?language=objc"><code>UIGestureRecognizer</code></a> subclasses.</p></blockquote><h1 id="é…ç½®ä¸€ä¸ªGesture-Recognizer"><a href="#é…ç½®ä¸€ä¸ªGesture-Recognizer" class="headerlink" title="é…ç½®ä¸€ä¸ªGesture  Recognizer"></a><strong>é…ç½®ä¸€ä¸ªGesture  Recognizer</strong></h1><p>æ­¥éª¤ï¼š</p><ol><li>åœ¨storyboardä¸­ï¼Œæ‹–ä¸€ä¸ªGesture  Recognizeråˆ°ä½ çš„ VIew ä¸Š</li><li>å®ç°å¯¹åº”çš„ action å‡½æ•°ã€‚æŸ¥çœ‹æ¥ä¸‹æ¥çš„ä»£ç </li><li>å°†ä½ çš„ actionå‡½æ•°è¿åˆ°é‚£ä¸ªGesture  Recognizer</li></ol><p>ä½ å¯ä»¥åœ¨Interface Builderåˆ›å»ºè¿™ä¸ªè¿æ¥ï¼Œåªéœ€è¦å³å‡»Gesture  Recognizerå’Œè¿æ¥å®ƒçš„Sent Action selector åˆ°ä½ æ¥å£ä¸­çš„åˆé€‚å¯¹è±¡ã€‚ä½ ä¹Ÿå¯ä»¥ç”¨çº¯ä»£ç çš„æ–¹å¼â€”â€”<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1624230-addtarget?language=objc"><code>addTarget:action:</code></a>ã€‚</p><p>ä»¥ä¸‹ä»£ç å±•ç¤ºäº†ä¸€ä¸ªGesture  Recognizerçš„ action å‡½æ•°ï¼Œå®ƒçš„ä¸€èˆ¬å½¢å¼ï¼š</p><div class="code-wrapper"><pre><code class="hljs objc">- (<span class="hljs-keyword">IBAction</span>)myActionMethod:(<span class="hljs-built_in">UIGestureRecognizer</span>*)sender</code></pre></div><h1 id="å“åº”æ‰‹åŠ¿"><a href="#å“åº”æ‰‹åŠ¿" class="headerlink" title="å“åº”æ‰‹åŠ¿"></a><strong>å“åº”æ‰‹åŠ¿</strong></h1><p>action å‡½æ•°æä¾›äº†ä½ çš„ App å¯¹æ‰‹åŠ¿çš„ååº”ã€‚å¯¹äºç¦»æ•£çš„Gesture  Recognizerï¼Œä½ çš„ action å‡½æ•°ä¼šè·Ÿ UIButtonçš„ action å‡½æ•°å·®ä¸å¤šã€‚ä¸€æ—¦ action å‡½æ•°æ‰§è¡Œï¼Œä½ å°±æ‰§è¡Œåˆç†çš„ä»»åŠ¡ã€‚</p><p>è€Œå¯¹äºè¿ç»­çš„Gesture  Recognizerï¼Œä½ çš„ action å‡½æ•°å¯ä»¥å“åº”æ‰‹åŠ¿è¯†åˆ«åï¼Œä¹Ÿå¯ä»¥åœ¨è¯†åˆ«æˆåŠŸå‰è·Ÿè¸ªäº‹ä»¶ã€‚è·Ÿè¸ªäº‹ä»¶èƒ½å¤Ÿåˆ›é€ æ›´æœ‰äº’åŠ¨æ€§çš„ä½“éªŒã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥<a href="https://developer.apple.com/documentation/uikit/uipangesturerecognizer?language=objc"><code>UIPanGestureRecognizer</code></a>å¯¹è±¡é‡Œçš„ã€Œä¿¡æ¯æ›´æ–°ã€æ¥ç§»åŠ¨ä½ App é‡Œçš„å†…å®¹ã€‚</p><p>Gesture  Recognizerçš„<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizer/1619998-state?language=objc"><code>state</code></a>å±æ€§ï¼Œèƒ½å‘Šè¯‰æˆ‘ä»¬å¯¹è±¡<strong>å½“å‰çš„è¯†åˆ«çŠ¶æ€</strong>ã€‚è¿ç»­çš„Gesture  Recognizerçš„ state å±æ€§ï¼Œå–å€¼èŒƒå›´æ˜¯<a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatebegan?language=objc"><code>UIGestureRecognizerStateBegan</code></a> ï¼ˆå¼€å§‹ï¼‰ã€ <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatechanged?language=objc"><code>UIGestureRecognizerStateChanged</code></a> ï¼ˆæ”¹å˜ï¼‰ã€ <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstateended?language=objc"><code>UIGestureRecognizerStateEnded</code></a>ï¼ˆç»“æŸï¼‰ï¼Œè¿˜æœ‰ <a href="https://developer.apple.com/documentation/uikit/uigesturerecognizerstate/uigesturerecognizerstatecancelled?language=objc"><code>UIGestureRecognizerStateCancelled</code></a>.ï¼ˆå–æ¶ˆï¼‰ã€‚ä½ å¯ä»¥åœ¨ action å‡½æ•°é‡Œæ ¹æ®è¿™ä¸ª state æ¥åšæ“ä½œã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥ç”¨ã€Œå¼€å§‹ã€ã€Œæ”¹å˜ã€ä¸¤ä¸ªstate æ¥å¯¹å†…å®¹åšä¸€äº›ä¸´æ—¶çš„æ”¹å˜ï¼Œç”¨ã€Œç»“æŸã€state æ¥ä½¿ã€Œæ”¹å˜ã€æˆæ•ˆã€‚</p><p>åœ¨è¿›è¡Œä»»ä½•æ“ä½œä¹‹å‰ï¼Œæ°¸è¿œéƒ½è¦å…ˆæ£€æŸ¥ state çš„å€¼ã€‚</p><hr><p>å¦‚ä½•å¤„ç†ç‰¹å®šçš„æ‰‹åŠ¿ï¼Œä»¥ä¸‹é“¾æ¥ç»™å‡ºäº†ä¸€äº›ä¾‹å­ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_tap_gestures?language=objc">Handling tap gestures</a>ç‚¹å‡»</li><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_long-press_gestures?language=objc">Handling long-press gestures</a>é•¿æŒ‰</li><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_pan_gestures?language=objc">Handling pan gestures</a>å¹³ç§»ï¼ˆå„ä¸ªæ–¹å‘ï¼‰</li><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_swipe_gestures?language=objc">Handling swipe gestures</a>æ»‘åŠ¨ï¼ˆå•ä¸ªæ–¹å‘ï¼‰</li><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_pinch_gestures?language=objc">Handling pinch gestures</a>æåˆ</li><li><a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/handling_uikit_gestures/handling_rotation_gestures?language=objc">Handling rotation gestures</a>æ—‹è½¬</li></ul><p>å¦‚æœè¦äº†è§£æ›´å¤šæœ‰å…³ Gesture  Recognizer stateç›¸å…³ä¿¡æ¯ä»¥åŠå®ƒä»¬å¦‚ä½•å½±å“ä½ çš„ä»£ç ï¼Œè¯·çœ‹<a href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/implementing_a_custom_gesture_recognizer?language=objc">å®ç°ä¸€ä¸ªè‡ªå®šä¹‰çš„æ‰‹åŠ¿è¯†åˆ«å™¨</a>ã€‚</p><blockquote><p>æ€»ç»“ï¼šæœ¬æ–‡ä»‹ç»äº† Gesture Recognizer çš„å·¥ä½œæ¨¡å¼ã€æœ‰å“ªä¸¤ç§ Gesture Recognizer ã€ å¦‚ä½•é…ç½®Gesture Recognizer ä»¥åŠ Gesture Recognizer çš„ state å±æ€§ã€‚</p></blockquote>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ºäº†ç ”ç©¶æ‰‹åŠ¿è¯†åˆ«å™¨ï¼Œæˆ‘ä¸€å£æ°”ç¿»è¯‘äº†å››ç¯‡æ–‡æ¡£</title>
    <link href="/2023/09/03/GestureRecognizer/"/>
    <url>/2023/09/03/GestureRecognizer/</url>
    
    <content type="html"><![CDATA[<ol><li><p>Handling UIKit gestures å¤„ç† UIKit çš„æ‰‹åŠ¿</p><p> å¼•å‡º Gesture Recognizerï¼Œä»‹ç»äº† ta æœ‰å“ªäº›ç±»å‹ï¼Œä»¥åŠæ€ä¹ˆé…ç½®ä¸€ä¸ª Gesture Recognizerã€‚æ–‡ç« ä¸é•¿ã€‚</p></li><li><p>Implementing a custom gesture recognizer å®ç°è‡ªå®šä¹‰çš„ Gesture Recognizer</p><p> ç»™å‡ºäº†ä¸€ä¸ªè‡ªå®šä¹‰ Gesture Recognizerçš„ demoï¼ŒåŒæ—¶ä¹Ÿè¯´äº†å¦‚æœè¦è‡ªå®šä¹‰çš„è¯éœ€è¦å®ç°å“ªäº›æ–¹æ³•ã€‚</p></li><li><p><strong>About the Gesture Recognizer State Machine å…³äºæ‰‹åŠ¿è¯†åˆ«å™¨çš„çŠ¶æ€æœº</strong></p><p> ä»‹ç»äº† Gesture Recognizerçš„ state å±æ€§ã€‚ä¸åŒç±»å‹çš„ Gesture Recognizeræ€ä¹ˆä½¿ç”¨ state å±æ€§ï¼Œå¦‚ä½•å–æ¶ˆæ‰‹åŠ¿è¯†åˆ«ï¼Œä»¥åŠæœ€ç»ˆå¦‚ä½•é‡ç½® Gesture Recognizerã€‚éƒ½æ˜¯å›´ç»• state çš„å˜åŒ–è®¨è®ºçš„ï¼Œæ¨èã€‚</p></li><li><p><strong>Supporting Gesture Interaction in Your Apps åœ¨ App ä¸­æ”¯æŒæ‰‹åŠ¿äº’åŠ¨</strong></p><p> ç”¨ä¸€ä¸ªç¤ºä¾‹å·¥ç¨‹ piecesï¼Œä»‹ç»äº†å¦‚ä½•å¤„ç†å¹³ç§»ã€æåˆå’Œæ—‹è½¬æ‰‹åŠ¿ï¼Œä»¥åŠæ€ä¹ˆè®©æ‰‹åŠ¿åŒæ—¶å·¥ä½œï¼Œæœ€åæ˜¯ä»‹ç»äº†å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª Gesture Recognizerå¤„ç†éæ ‡å‡†çš„æ‰‹åŠ¿</p></li></ol><p>è‹¹æœçš„æ–‡æ¡£ä¸å¾—ä¸è¯´æ˜¯æœ‰ç‚¹å•°å—¦å’Œç¹ççš„ï¼Œæœ‰æ—¶å€™ä¸€ä¸ªæ„æ€ç¿»è¿‡æ¥å€’è¿‡å»è®²ä¸¤ä¸‰éï¼Œç›´æ¥çœ‹è‹±æ–‡çš„è¯å°±å¾ˆå®¹æ˜“å°±çœ‹èµ°ç¥äº†ï¼Œäºæ˜¯æˆ‘å°±æƒ³ç€æŠŠå®ƒç¿»è¯‘è¿‡æ¥ï¼Œæ­£è§† taã€‚</p><p>æ¨èæ˜¯å…ˆçœ‹ç‚¹ä¸­æ–‡çš„æ–‡ç« ï¼Œå¯¹ä¸€äº›æ¦‚å¿µæœ‰äº†è§£äº†ï¼Œç„¶åå†è®¤çœŸçœ‹ç¬¬ 3 ç¬¬ 4 ç¯‡æ–‡æ¡£ï¼Œå¯¹  Gesture Recognizerå°±èƒ½æœ‰ä¸€ä¸ªæ¯”è¾ƒå…¨é¢çš„å°è±¡ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>UIPickerView å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„æ ·å¼?</title>
    <link href="/2023/08/29/UIPickerView-%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E9%80%89%E4%B8%AD%E8%A1%8C%E7%9A%84%E6%A0%B7%E5%BC%8F/"/>
    <url>/2023/08/29/UIPickerView-%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E9%80%89%E4%B8%AD%E8%A1%8C%E7%9A%84%E6%A0%B7%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="UIPickerView-å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„æ ·å¼"><a href="#UIPickerView-å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„æ ·å¼" class="headerlink" title="UIPickerView å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„æ ·å¼"></a>UIPickerView å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„æ ·å¼</h1><p><img src="/../image/UIPickerView/UIPickerView.png"></p><p>æœ¬æ–‡ä¼šä»‹ç»ä¸¤ä¸ªæˆ‘åœ¨ä½¿ç”¨ UIPickerView æ—¶é‡åˆ°çš„é—®é¢˜, æœ€åç»™å‡ºå®ƒä»¬çš„è§£å†³æ–¹æ³•ï¼š</p><ol><li>å¦‚ä½•<strong>æ— å»¶è¿Ÿ</strong>åœ°æ›´æ–°é€‰ä¸­è¡Œçš„æ ·å¼ï¼Ÿ</li><li>å¦‚ä½•ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²ï¼Ÿ</li></ol><h2 id="é€‰ä¸­è¡Œçš„æ ·å¼"><a href="#é€‰ä¸­è¡Œçš„æ ·å¼" class="headerlink" title="é€‰ä¸­è¡Œçš„æ ·å¼"></a>é€‰ä¸­è¡Œçš„æ ·å¼</h2><p>éœ€æ±‚ä¸­ï¼Œè¦æ±‚æ›´æ”¹é€‰ä¸­è¡Œçš„å­—ä½“é¢œè‰²å’Œå­—é‡ï¼ŒåŠ ç²—+å˜è‰²ã€‚æˆ‘ä¸€å¼€å§‹å°è¯•åœ¨ã€Œé€‰ä¸­å›è°ƒå‡½æ•°pickerView:didSelectRow:inComponent: ã€ è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œè·å–å½“å‰é€‰ä¸­çš„ viewï¼Œç„¶åä¿®æ”¹å®ƒçš„æ ·å¼ï¼Œä½†æ˜¯è¿™æ ·çš„æ•ˆæœä¸å¤Ÿä¸æ»‘ï¼Œéœ€è¦æ¾å¼€æ‰‹ã€æœ‰å¤§çº¦ 0.5s çš„å»¶è¿Ÿï¼Œæ‰ä¼šçœ‹åˆ°é€‰ä¸­æ•ˆæœ</p><p><img src="/../image/UIPickerView/NotSelected.gif"></p><p>åŒæ—¶è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨ç”¨æˆ·è¿˜æ²¡æœ‰å¼€å§‹æ»šåŠ¨é€‰æ‹©ä¹‹åˆï¼Œå½“å‰é€‰ä¸­è¡Œæ˜¯æ²¡æœ‰ã€Œé€‰ä¸­æ•ˆæœã€çš„ã€‚å“ªæ€•æ‰‹åŠ¨è°ƒç”¨</p><p>selectRow:inComponent:animated: å‡½æ•°ï¼ŒpickerViewä¹Ÿæ»‘åˆ°äº†æŒ‡å®šè¡Œï¼Œä¹Ÿä¸ä¼šè§¦å‘pickerView:didSelectRow:inComponent: è¿™ä¸ªå›è°ƒã€‚</p><blockquote><p>è¿™ä¸ªé—®é¢˜å…¶å®æˆ‘è¿˜æ²¡ç ”ç©¶æ¸…æ¥šä¸ºå•¥ï¼ŒæœŸå¾…æœ‰çŸ¥é“çš„å¤§ä½¬æŒ‡ç‚¹ä¸€ä¸‹è¿·æ´¥</p></blockquote><p>äºæ˜¯æˆ‘å»github ä¸Šçœ‹çœ‹æœ‰æ²¡æœ‰äººè§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ª star æ•°æœ‰2k+çš„<a href="https://github.com/91renb/BRPickerView" title="BRPickerView">BRPickerView</a>ï¼Œäººå®¶çš„é€‰ä¸­æ•ˆæœå°±å¾ˆä¸æ»‘ï¼Œç¿»äº†ç¿»ä»£ç ï¼Œå‘ç°ta æ˜¯åœ¨pickerView:viewForRow:forComponent:reusingView: ä¸­è®¾ç½®å½“å‰é€‰ä¸­è¡Œçš„æ ·å¼ï¼Œå¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs objc">- (<span class="hljs-built_in">UIView</span> *)pickerView:(<span class="hljs-built_in">UIPickerView</span> *)pickerView viewForRow:(<span class="hljs-built_in">NSInteger</span>)row forComponent:(<span class="hljs-built_in">NSInteger</span>)component reusingView:(<span class="hljs-built_in">UIView</span> *)view &#123;    <span class="hljs-comment">// è®¾ç½®é€‰ä¸­è¡Œå­—ä½“é¢œè‰²å’Œå­—ä½“å¤§å°</span>    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="hljs-number">0</span> * <span class="hljs-built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;        <span class="hljs-built_in">UILabel</span> *label = (<span class="hljs-built_in">UILabel</span> *)[pickerView viewForRow:row forComponent:component];        label.textColor = <span class="hljs-built_in">UIColor</span>.blueColor;        [label setFont:[<span class="hljs-built_in">UIFont</span> systemFontOfSize:<span class="hljs-number">20</span> weight:<span class="hljs-number">20</span>]];    &#125;);  &#125;&#125;</code></pre></div><p>ä½†æ˜¯ä¸ºä»€ä¹ˆè¦æ”¾åœ¨<strong>dispatch_after</strong> é‡Œç«‹å³æ‰§è¡Œï¼Œè¿™ä¸ªæš‚æ—¶ä¹Ÿä¸å¤ªæ¸…æ¥šï¼Œæˆ‘è‡ªå·±åŠ¨æ‰‹æµ‹è¯•ï¼Œä¸åŒ…è¿™ä¸€å±‚ä¸å½±å“æ•ˆæœï¼ŒçŒœæµ‹æ˜¯åŒ…äº†è¿™ä¸€å±‚åèƒ½å¤Ÿä¿è¯å…¶ä¸­çš„ä»£ç èƒ½å¤Ÿç«‹åˆ»åœ¨ä¸»é˜Ÿåˆ—æ‰§è¡Œï¼ŒåŒæ—¶é¿å…å‘ç”Ÿå­çº¿ç¨‹ä¿®æ”¹ UIè€Œ crashçš„æƒ…å†µã€‚</p><p>çœ‹äº†ä¸‹<strong>pickerView:viewForRow:forComponent:reusingView:</strong> çš„æ–‡æ¡£ï¼Œ</p><blockquote><p>Called by the picker view when it needs the view to use for a given row in a given component.<br>*å½“ pickerView éœ€è¦é‚£ä¸ª view ç”¨äºæŒ‡å®šåˆ—ä¸­çš„æŒ‡å®šè¡Œæ—¶ï¼Œå®ƒä¼šè°ƒç”¨è¯¥æ–¹æ³•æ¥è·å–ã€‚<br>*</p><p>æˆ‘è‡ªå·±ç»è¿‡æµ‹è¯•ï¼Œåˆå§‹åŒ–å’Œæ»šåŠ¨æ—¶éƒ½ä¼šè°ƒç”¨è¿™ä¸ªå›è°ƒï¼Œè€Œä¸”ä¸æ­¢ä¸€æ¬¡</p><p>åˆå§‹åŒ–ï¼š#2    0x00000001144c2060 in -[UIPickerView tableView:cellForRowAtIndexPath:] ()ã€‚<strong>5</strong> ä¸ªå…ƒç´ çš„ pickerView è°ƒç”¨äº† **8 <strong>æ¬¡è¯¥å‡½æ•°<br>æ»‘åŠ¨ï¼š#1    0x0000000113e59060 in -[UIPickerView tableView:cellForRowAtIndexPath:] ()ï¼Œè°ƒç”¨</strong> 2 **æ¬¡</p></blockquote><hr><p><strong>anywayï¼ŒæŠŠä¿®æ”¹æ ·å¼çš„ä»£ç æ”¾åˆ°pickerView:viewForRow:forComponent:reusingView:åï¼Œä¸ä»…ä¸æ»‘äº†å¾ˆå¤šï¼Œè€Œä¸”åœ¨åˆå§‹ã€ç”¨æˆ·æœªæ»šåŠ¨çš„æ—¶å€™ä¹Ÿèƒ½ä¿è¯æœ‰é€‰ä¸­æ•ˆæœï¼ŒæˆåŠŸå®ç°éœ€æ±‚ã€‚</strong></p><p><img src="/../image/UIPickerView/SelectedEffect.gif"></p><h2 id="ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²"><a href="#ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²" class="headerlink" title="ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²"></a>ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²</h2><p>è¿˜æœ‰ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚å°±æ˜¯ä¿®æ”¹é€‰ä¸­è¡Œçš„èƒŒæ™¯é¢œè‰²ï¼Œå¦‚ä¸Šå›¾ï¼Œé€‰ä¸­è¡Œçš„ View æˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>[pickerView viewForRow:row forComponent:component]</strong> è¿™æ ·çš„ä»£ç è·å–ï¼Œä½†æ˜¯æœ‰é—®é¢˜, å¦‚æœç»™è¿™ä¸ª View è®¾ç½®èƒŒæ™¯é¢œè‰²ï¼Œå‰é¢ä¼šç•™æœ‰ç©ºéš™ï¼Œå¦‚å›¾ï¼š</p><p><img src="/../image/UIPickerView/gap.png"></p><p>è¿™åŠæ³•è¿˜ä¸è¡Œï¼Œå¾—æ‰¾åˆ°å¤–éƒ¨çš„å®¹å™¨ï¼Œä¿®æ”¹å®ƒçš„èƒŒæ™¯é¢œè‰²æ‰è¡Œã€‚åœ¨ BRPickerView ä¸­æ‰¾åˆ°çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="code-wrapper"><pre><code class="hljs objc"><span class="hljs-comment">// è®¾ç½®é€‰ä¸­è¡ŒèƒŒæ™¯è‰²</span>    <span class="hljs-comment">// 1. è·å– pickerView çš„å­ Viewï¼ˆæœ‰å¤šä¸ªï¼‰ï¼Œå–ç¬¬ä¸€ä¸ª viewï¼Œç§°ä¹‹ä¸º contentView</span>    <span class="hljs-built_in">UIView</span> *contentView = <span class="hljs-literal">nil</span>;    <span class="hljs-built_in">NSArray</span> *subviews = pickerView.subviews;    <span class="hljs-keyword">if</span> (subviews.count &gt; <span class="hljs-number">0</span>) &#123;        <span class="hljs-type">id</span> firstObj = subviews.firstObject;        <span class="hljs-keyword">if</span> (firstObj &amp;&amp; [firstObj isKindOfClass:[<span class="hljs-built_in">UIView</span> <span class="hljs-keyword">class</span>]]) &#123;            contentView = (<span class="hljs-built_in">UIView</span> *)firstObj;        &#125;    &#125;        <span class="hljs-comment">// 2. åœ¨ contentView ä¸­é€šè¿‡ KVC å–å®ƒçš„ subviewCache å±æ€§ï¼Œç§°ä¸º columnView</span>    <span class="hljs-built_in">UIView</span> *columnView = <span class="hljs-literal">nil</span>;    <span class="hljs-keyword">if</span> (contentView) &#123;        <span class="hljs-type">id</span> obj = [contentView valueForKey:<span class="hljs-string">@&quot;subviewCache&quot;</span>];        <span class="hljs-keyword">if</span> (obj &amp;&amp; [obj isKindOfClass:[<span class="hljs-built_in">NSArray</span> <span class="hljs-keyword">class</span>]]) &#123;            <span class="hljs-built_in">NSArray</span> *columnViewArray = (<span class="hljs-built_in">NSArray</span> *)obj;            <span class="hljs-keyword">if</span> (columnViewArray.count &gt; <span class="hljs-number">0</span>) &#123;                <span class="hljs-type">id</span> columnObj = columnViewArray.firstObject;                <span class="hljs-keyword">if</span> (columnObj &amp;&amp; [columnObj isKindOfClass:[<span class="hljs-built_in">UIView</span> <span class="hljs-keyword">class</span>]]) &#123;                    columnView = (<span class="hljs-built_in">UIView</span> *)columnObj;                &#125;            &#125;        &#125;    &#125;        <span class="hljs-comment">// 2.è¿˜ç”¨ KVCï¼Œå– columnView çš„ middleContainerViewï¼Œä¿®æ”¹å®ƒçš„èƒŒæ™¯é¢œè‰²å³å¯</span>    <span class="hljs-keyword">if</span> (columnView) &#123;        <span class="hljs-type">id</span> containerObj = [columnView valueForKey:<span class="hljs-string">@&quot;middleContainerView&quot;</span>];        <span class="hljs-keyword">if</span> (containerObj &amp;&amp; [containerObj isKindOfClass:[<span class="hljs-built_in">UIView</span> <span class="hljs-keyword">class</span>]]) &#123;            <span class="hljs-built_in">UIView</span> *selectedRowViewContainer = (<span class="hljs-built_in">UIView</span> *)containerObj;            <span class="hljs-comment">// æœ€ç»ˆè®¾ç½®èƒŒæ™¯æ¡†çš„é¢œè‰²</span>            selectedRowViewContainer.backgroundColor = <span class="hljs-built_in">UIColor</span>.blackColor;        &#125;    &#125;</code></pre></div><p>åˆ°è¿™é‡Œæˆ‘ä¸ç¦æƒ³ä¸ºä»€ä¹ˆ Apple çš„è®¾è®¡æ€è·¯è¿™ä¹ˆå¤æ€ªï¼Œè¿™ä¹ˆä¸€ä¸ªå¸¸ç”¨çš„å±æ€§ä¸ºä»€ä¹ˆä¸æš´éœ²ç»™å¼€å‘è€…å‘¢ï¼Œå°±å« selectedRowViewContainer ä¹‹ç±»çš„ã€‚</p><p><strong>çªç„¶ï¼</strong>æˆ‘åˆæƒ³åˆ°äº†ä¸€ä¸ªåˆ«çš„æ–¹æ³•ï¼Œæ—¢ç„¶é‡Œå±‚é€‰ä¸­è¡Œçš„ View å¯ä»¥è·å–åˆ°ï¼Œè€Œå®¹å™¨è‚¯å®šæ˜¯åŒ…å«è¿™ä¸ªã€Œé€‰ä¸­è¡Œ Viewã€ï¼Œé‚£æˆ‘ä»ã€Œé€‰ä¸­è¡Œ Viewã€å‡ºå‘ï¼Œä¸€è·¯æ‰¾å®ƒçš„çˆ¶è§†å›¾ï¼Œè‚¯å®šå¯ä»¥æ‰¾åˆ°å“‡ï¼è¿™ç§æ–¹æ³•çš„<strong>ä»£ç é‡å°±å°‘å¾ˆå¤šäº†ã€‚</strong></p><p>ç»è¿‡æµ‹è¯•ï¼Œæœ€ç»ˆçš„ä»£ç æ˜¯ï¼š</p><div class="code-wrapper"><pre><code class="hljs objc"><span class="hljs-built_in">UILabel</span> *label = (<span class="hljs-built_in">UILabel</span> *)[pickerView viewForRow:row forComponent:component];<span class="hljs-built_in">UIView</span> *container = [[[[label superview] superview] superview] superview]; <span class="hljs-comment">// 4ä¸ª superView</span></code></pre></div><p><img src="/../image/UIPickerView/ViewHierarchyDiagram.png"></p><p>æ•ˆæœæ˜¯ä¸€æ ·çš„</p><p><img src="/../image/UIPickerView/Solved.png"></p><p>è‡³æ­¤ï¼Œæ–‡ç« å¼€å¤´è¯´çš„ä¸¤ä¸ªé—®é¢˜åœ†æ»¡è§£å†³ï¼ğŸ‰åº†ç¥</p><hr><p>è¯´ç‚¹é¢˜å¤–è¯ï¼Œè¿™ä¸ªéœ€æ±‚å…¶å®æ˜¯ä¸´æ—¶åŠ ä¸Šæ¥çš„ï¼Œæ’æœŸå¾ˆç´§å¼ ï¼Œæˆ‘å¯¹UIPickerView è¿™ä¸ªæ§ä»¶å®Œå…¨æ²¡æœ‰ç»éªŒï¼Œå°±æƒ³ç€æ‰¾ä¸€æ‰¾é¡¹ç›®é‡Œä»¥å‰æœ‰æ²¡æœ‰ç”¨è¿‡ï¼Œç„¶åæŠŠå®ƒæŠ„è¿‡æ¥ã€‚ä½†æ˜¯ä¸€ç›´æ²¡æœ‰è§£å†³å¥½æ–‡ç« æåˆ°çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ŒåŠ ä¸Šéš”å£ Android çš„åŒäº‹å¾ˆå¿«å°±å†™å‡ºæ¥äº†ï¼Œè¶Šå†™è¶Šæ€¥ã€‚å…¶å®æ˜¯åº”è¯¥æ²‰ä¸‹å¿ƒæ¥çš„ï¼Œè®¤çœŸè¯»æ–‡æ¡£å’Œä¸‰æ–¹åº“ï¼Œè€Œä¸æ˜¯æ²¡æœ‰è®¡åˆ’ã€æ²¡æœ‰ç« æ³•åœ°ä¹±è¯•ï¼Œè¿™ä¸ªæ˜¯æˆ‘è‡ªå·±çš„æ¯›ç—…ï¼Œæˆ‘è¦æ”¹æ­£ã€‚</p><hr><p>PS. åœ¨ç ”ç©¶è¿™ä¸ªé—®é¢˜çš„æ—¶å€™å‘ç°ï¼Œæ‹¼å¤šå¤šApp ä¸­çš„ã€Œæˆ‘çš„èµ„æ–™ã€é¡µï¼Œå…¶ä¸­çš„åœ°åŒºé€‰æ‹©åŒ…å«çš„ pickerView ä¹Ÿæœ‰è¿™ä¸ªå»¶è¿Ÿæƒ…å†µã€‚</p><p><img src="/../image/UIPickerView/PinDuoDuo.gif"></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºCocoapodsä½ æƒ³è¦äº†è§£çš„ä¸€åˆ‡</title>
    <link href="/2022/09/12/%E5%85%B3%E4%BA%8ECocoapods%E4%BD%A0%E6%83%B3%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E4%B8%80%E5%88%87/"/>
    <url>/2022/09/12/%E5%85%B3%E4%BA%8ECocoapods%E4%BD%A0%E6%83%B3%E8%A6%81%E4%BA%86%E8%A7%A3%E7%9A%84%E4%B8%80%E5%88%87/</url>
    
    <content type="html"><![CDATA[<p><img src="/../image/cocoapods.png"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>CocoaPods æ˜¯æˆ‘ç°åœ¨æ¯å¤©ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹ä¾èµ–ç®¡ç†åº“ï¼Œç²¾é€š<code>pod install </code>ï¼Œ<code>pod install â€”repo update</code> ï¼Œåˆ é™¤ <code>Podfile.lock</code>æ–‡ä»¶ç­‰æ“ä½œã€‚</p><p>æˆ‘ä»æ²¡è§‰å¾—è¿™æœ‰ä»€ä¹ˆäº†ä¸èµ·çš„ã€‚ç›´åˆ°åœ¨ä¸€æ¬¡é¢è¯•ä¸­å­—èŠ‚è·³åŠ¨çš„é¢è¯•å®˜é—®æˆ‘ï¼šCocoaPods çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åƒæˆ‘è¿™æ ·å¹´è½»çš„ç¨‹åºå‘˜ä¸åº”è¯¥æ»¡è¶³äºå®Œæˆæ—¥å¸¸å¼€å‘ä»»åŠ¡ï¼Œäº†è§£ä¸‹ CocoaPodså§ã€‚</p><h1 id="CocoaPods-ä¸ºä»€ä¹ˆå¯ä»¥ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Ÿ"><a href="#CocoaPods-ä¸ºä»€ä¹ˆå¯ä»¥ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Ÿ" class="headerlink" title="CocoaPods ä¸ºä»€ä¹ˆå¯ä»¥ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Ÿ"></a>CocoaPods ä¸ºä»€ä¹ˆå¯ä»¥ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Ÿ</h1><p>æˆ‘ä»¬æ‹‰å–äº†ä¸€ä¸ªé¡¹ç›®åï¼Œå¾€å¾€è¦åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œpod install ï¼Œä»è€Œå°†é¡¹ç›®çš„ç¬¬ä¸‰æ–¹ä¾èµ–åº“<strong>ä¸‹è½½</strong>ä¸‹æ¥å¹¶<strong>å¯¼å…¥</strong>é¡¹ç›®ä¸­ï¼Œpod installåä¼šäº§ç”Ÿä¸€ä¸ª xcworkspace æ–‡ä»¶ï¼Œæˆ‘ä»¬æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå°±èƒ½åœ¨ Xcode ä¸­æ‰“å¼€ä¸€ä¸ªå·²ç»æŠŠç¬¬ä¸‰æ–¹ä¾èµ–åº“å¯¼å…¥çš„é¡¹ç›®ï¼Œç›´æ¥ Run å°±å¯ä»¥äº†ã€‚</p><p>æ‰€ä»¥ï¼ŒCocoaPods ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–çš„å¥¥ç§˜åœ¨äº<code>pod install</code></p><p>æ¥çœ‹ä¸‹ <code>pod install</code> çš„è¿‡ç¨‹ï¼ˆæ‰§è¡Œå‘½ä»¤<code>pod install --verbose</code>ï¼‰</p><div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">pod install --verbose</span> 1.åˆ†æä¾èµ–Analyzing dependencies Updating spec repositoriesUpdating spec repo `master`<span class="hljs-meta prompt_">  $ </span><span class="language-bash">/usr/bin/git pull</span>  Already up-to-date.Finding Podfile changes  - AFNetworking  - HockeySDKResolving dependencies of `Podfile`Resolving dependencies for target `Pods&#x27; (iOS 6.0)  - AFNetworking (= 1.2.1)  - SDWebImage (= 3.2)    - SDWebImage/CoreComparing resolved specification to the sandbox manifest  - AFNetworking  - HockeySDK2. ä¸‹è½½ä¾èµ–Downloading dependencies<span class="hljs-meta prompt_"></span><span class="hljs-meta prompt_">-&gt; </span><span class="language-bash">Using AFNetworking (1.2.1)</span><span class="hljs-meta prompt_"></span><span class="hljs-meta prompt_">-&gt; </span><span class="language-bash">Using HockeySDK (3.0.0)</span>  - Running pre install hooks    - HockeySDK3. ç”Ÿæˆ Pods é¡¹ç›®Generating Pods project  - Creating Pods project  - Adding source files to Pods project  - Adding frameworks to Pods project  - Adding libraries to Pods project  - Adding resources to Pods project  - Linking headers  - Installing libraries    - Installing target `Pods-AFNetworking` iOS 6.0      - Adding Build files      - Adding resource bundles to Pods project      - Generating public xcconfig file at `Pods/Pods-AFNetworking.xcconfig`      - Generating private xcconfig file at `Pods/Pods-AFNetworking-Private.xcconfig`      - Generating prefix header at `Pods/Pods-AFNetworking-prefix.pch`      - Generating dummy source file at `Pods/Pods-AFNetworking-dummy.m`    - Installing target `Pods-HockeySDK` iOS 6.0      - Adding Build files      - Adding resource bundles to Pods project      - Generating public xcconfig file at `Pods/Pods-HockeySDK.xcconfig`      - Generating private xcconfig file at `Pods/Pods-HockeySDK-Private.xcconfig`      - Generating prefix header at `Pods/Pods-HockeySDK-prefix.pch`      - Generating dummy source file at `Pods/Pods-HockeySDK-dummy.m`    - Installing target `Pods` iOS 6.0      - Generating xcconfig file at `Pods/Pods.xcconfig`      - Generating target environment header at `Pods/Pods-environment.h`      - Generating copy resources script at `Pods/Pods-resources.sh`      - Generating acknowledgements at `Pods/Pods-acknowledgements.plist`      - Generating acknowledgements at `Pods/Pods-acknowledgements.markdown`      - Generating dummy source file at `Pods/Pods-dummy.m`  - Running post install hooks  - Writing Xcode project file to `Pods/Pods.xcodeproj`  - Writing Lockfile in `Podfile.lock`  - Writing Manifest in `Pods/Manifest.lock`4. é›†æˆåˆ°ä¸»é¡¹ç›®ä¸­ï¼Œç”Ÿæˆ xcworkspace æ–‡ä»¶Integrating client project</code></pre></div><h3 id="1-åˆ†æä¾èµ–"><a href="#1-åˆ†æä¾èµ–" class="headerlink" title="1. åˆ†æä¾èµ–"></a>1. åˆ†æä¾èµ–</h3><p>é¦–å…ˆè¯»å– Podfile æ–‡ä»¶ï¼Œè§£æå‡ºæ˜¯å¦æœ‰æ–°å¢çš„ pod éœ€è¦ installï¼Œè¢«åˆ é™¤çš„ pod éœ€è¦ removeã€‚</p><p>ç„¶åè¯»å– Podfile.lockæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰ï¼Œç¡®å®šä¸Šä¸€æ¬¡ pod install æˆåŠŸçš„ pod ç‰ˆæœ¬å·ã€‚</p><p>æœ€åæ˜¯è§£å†³å†²çªï¼Œæ ¹æ® <a href="http://semver.org/" title="Semantic Versioning">Semantic Versioning</a> é‡Œå®šä¹‰çš„åŸåˆ™ï¼Œç¡®å®šç¬¬ä¸‰æ–¹ä¾èµ– pod çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœç¢°åˆ°æ— æ³•è§£å†³ä¼šæŠ¥é”™ï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨æŒ‡å®š pod ç‰ˆæœ¬å·ã€‚ï¼ˆä¸­æ–‡æ–‡æ¡£çœ‹è¿™é‡Œï¼‰</p><blockquote><p>Semantic Versioningè¯­ä¹‰ç‰ˆæœ¬è§„åˆ™ï¼Œå®šä¹‰äº†pod çš„ç‰ˆæœ¬å·åº”è¯¥æ€ä¹ˆå†™ï¼š</p><p><strong>MAJOR.MINOR.PATCH</strong> (ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.è¡¥ä¸ç‰ˆæœ¬å·)ï¼Œ ä¾‹å¦‚ 1.12.60<br>å¦‚æœä¿®æ”¹äº† APIï¼Œåšäº†ä¸å…¼å®¹æ”¹é€ ï¼Œé‚£ä¹ˆåº”è¯¥ä¿®æ”¹ MAJORï¼Œ<strong>1</strong>.12.60â†’<strong>2</strong>.0.0<br>å¦‚æœåšäº†æ–°åŠŸèƒ½ï¼Œåº”è¯¥ä¿®æ”¹ MINORï¼Œ1.<strong>12</strong>.60â†’1.<strong>13</strong>.0<br>å¦‚æœä¿®å¤äº†æŸäº› bugï¼Œä¸å½±å“å½“å‰åŠŸèƒ½ï¼Œåº”è¯¥ä¿®æ”¹ PATCHï¼Œ1.12.<strong>60</strong>â†’1.12.<strong>80</strong></p></blockquote><h3 id="2-ä¸‹è½½ä¾èµ–"><a href="#2-ä¸‹è½½ä¾èµ–" class="headerlink" title="2. ä¸‹è½½ä¾èµ–"></a>2. ä¸‹è½½ä¾èµ–</h3><p>æ‹‰å– pod çš„æºç ï¼Œæ”¾åˆ° Pods ç›®å½•ä¸‹</p><h3 id="3-ç”ŸæˆPods-xcodeprojæ–‡ä»¶"><a href="#3-ç”ŸæˆPods-xcodeprojæ–‡ä»¶" class="headerlink" title="3. ç”ŸæˆPods.xcodeprojæ–‡ä»¶"></a>3. ç”ŸæˆPods.xcodeprojæ–‡ä»¶</h3><blockquote><p><code>xcodeproj</code> æ–‡ä»¶æ˜¯æ¯ä¸ªXcode é¡¹ç›®éƒ½æœ‰çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œé‡Œé¢è®°å½•äº†è¯¥é¡¹ç›®çš„å·¥ç¨‹é…ç½®ä¿¡æ¯</p></blockquote><p>è¿™ä¸€æ­¥æ˜¯é€šè¿‡ CocoaPods&#x2F;Xcodeproj è¿™ä¸ª gem åº“å»å®Œæˆçš„ã€‚</p><p>ç”±è¿™ä¸€æ­¥æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼š<strong>CocoaPods çš„åŸç†æ˜¯å°†æ‰€æœ‰çš„ä¾èµ–åº“éƒ½æ”¾åœ¨ Pods é¡¹ç›®ä¸‹ï¼Œä¸»é¡¹ç›®åªéœ€è¦ä¾èµ– Pods é¡¹ç›®ã€‚è¿™æ ·ï¼Œpod æºç ç®¡ç†å·¥ä½œå°±ä»ä¸»é¡¹ç›®è½¬åˆ° Pods é¡¹ç›®ä¸­ã€‚</strong></p><p>åœ¨è¿™ä¸€é˜¶æ®µï¼ŒCocoaPods è¿˜ä¼šå»æ›´æ–° Podfile.lock æ–‡ä»¶ã€Manifest.lock æ–‡ä»¶ï¼ˆè¯¥æ–‡ä»¶æ˜¯ Podfile.lock æ–‡ä»¶çš„å‰¯æœ¬ï¼Œç”¨äºé¿å…ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“æ—¶å¯èƒ½å‡ºç°çš„ crashï¼‰</p><h3 id="4-ç”Ÿæˆxcworkspace"><a href="#4-ç”Ÿæˆxcworkspace" class="headerlink" title="4. ç”Ÿæˆxcworkspace"></a>4. ç”Ÿæˆxcworkspace</h3><blockquote><p>xcworkspace å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢åŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼šcontents.xcworkspacedataä»¥åŠä¸¤ä¸ªå­æ–‡ä»¶å¤¹ xcshareddataï¼Œ xcuserdataã€‚contents.xcworkspacedataé‡Œè®°å½•äº†å½“å‰é¡¹ç›®æœ‰å“ªäº› projectã€‚</p></blockquote><hr><p>æœ€åï¼Œç‚¹å¼€è¿™ä¸ª xcworksapceï¼Œå°±èƒ½å¾—åˆ°ä¸€ä¸ªã€Œç¬¬ä¸‰æ–¹ä¾èµ–å·²ç»å‡†å¤‡å¥½äº†ï¼Œç¼–è¯‘ä¸€ä¸‹å°±èƒ½è·‘ã€çš„é¡¹ç›®</p><h1 id="pod-install-å’Œ-pod-update-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#pod-install-å’Œ-pod-update-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="pod install å’Œ pod update çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>pod install å’Œ pod update çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>åŒºåˆ«åœ¨äº<strong>æ˜¯å¦æŒ‰ç…§Podfile.lock æ¥å®‰è£… podã€‚</strong></p><p>pod install ä¼šæ ¹æ® Podfile.lock ä¸­å†™å¥½çš„ç‰ˆæœ¬å·å»æ‹‰å–pod çš„æºä»£ç ã€‚è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å¯ä»¥åˆ©ç”¨ä¸Šä¸€æ¬¡ pod install æˆåŠŸæ—¶çš„ç¬¬ä¸‰æ–¹åº“ç¯å¢ƒã€‚ï¼ˆå¦‚æœ Podfile.lock ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¼šè¿›è¡Œä¸€æ¬¡ä¾èµ–å…³ç³»åˆ†æï¼Œç¡®å®šç¬¦åˆæ¡ä»¶çš„ pod ç‰ˆæœ¬å·ï¼Œæœ€åå»æ‹‰å– pod ï¼‰</p><p>è€Œ pod update ä¼šå¿½è§† Podfile.lockï¼Œæ ¹æ® Podfile æ–‡ä»¶ï¼Œé€‰æ‹©ã€Œæ—¢ç¬¦åˆçº¦æŸæ¡ä»¶ï¼Œå°½å¯èƒ½æ–°ã€çš„ç‰ˆæœ¬å·ï¼Œpod update æˆåŠŸåä¼šæ›´æ–° Podfile.lock æ–‡ä»¶ã€‚</p><blockquote><p>å½“ä½ ä¿®æ”¹äº† Podfile æ–‡ä»¶ï¼Œé‚£åº”è¯¥ç”¨ pod install å®‰è£… pod<br>å½“ä½ æƒ³æ›´æ–° pod ç‰ˆæœ¬ï¼Œåº”è¯¥ç”¨ pod updateï¼Œæ›´æ–° pod</p></blockquote><p>æ‰€ä»¥å®˜æ–¹æ–‡æ¡£å»ºè®®ï¼Œå°† Podfile.lock æ”¾å…¥ç‰ˆæœ¬æ§åˆ¶ä¸­ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å›¢é˜Ÿé‡Œå¤§å®¶éƒ½ç”¨çš„æ˜¯åŒä¸€å¥—ç¯å¢ƒï¼ˆå°±æ˜¯å„ä¸ª pod çš„ç‰ˆæœ¬ä¸€è‡´ï¼‰ã€‚</p><blockquote><p>pod outdated ï¼šå¦‚æœPodfile.lock ä¸­çš„ pod æœ‰æ–°ç‰ˆæœ¬ï¼Œè¿™æ¡å‘½ä»¤ä¼šå°†å¯¹åº”çš„æ–°ç‰ˆæœ¬ç½—åˆ—å‡ºæ¥ã€‚æ‰€ä»¥å¯ä»¥ç”¨è¿™æ¡å‘½ä»¤æŸ¥çœ‹å·²ç»å®‰è£…çš„ pod æ˜¯å¦å¯ä»¥æ›´æ–°ç‰ˆæœ¬</p></blockquote><h1 id="Podfile-ä¸­å¦‚æœå†™æ­»äº†podç‰ˆæœ¬å·ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æŠ›å¼ƒPodfile-lock-äº†ï¼Ÿ"><a href="#Podfile-ä¸­å¦‚æœå†™æ­»äº†podç‰ˆæœ¬å·ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æŠ›å¼ƒPodfile-lock-äº†ï¼Ÿ" class="headerlink" title="Podfile ä¸­å¦‚æœå†™æ­»äº†podç‰ˆæœ¬å·ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æŠ›å¼ƒPodfile.lock äº†ï¼Ÿ"></a>Podfile ä¸­å¦‚æœå†™æ­»äº†podç‰ˆæœ¬å·ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æŠ›å¼ƒPodfile.lock äº†ï¼Ÿ</h1><p><strong>ä¸è¡Œ</strong>ï¼Œç†ç”±æ˜¯ ã€Œpod ä¾èµ–çš„ pod ã€çš„ç‰ˆæœ¬å·å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´ã€‚</p><p>å‡å¦‚é¡¹ç›®ç°åœ¨ä¾èµ–äº† A åº“ï¼ŒPodfile ä¸­è¿™ä¹ˆå†™ï¼š</p><div class="code-wrapper"><pre><code class="hljs ruby">pod <span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;1.0.0&#x27;</span></code></pre></div><p>ä½†æ˜¯ A ä¾èµ–äº†ä¸€ä¸ªåº“ Bï¼Œåœ¨ A çš„ podspec æ–‡ä»¶ä¸­æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š</p><div class="code-wrapper"><pre><code class="hljs ruby">dependency <span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;~&gt; 3.0&#x27;</span></code></pre></div><p>é‚£å°æ˜è·‘é¡¹ç›®çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯Aï¼ˆ1.0.0ï¼‰Bï¼ˆ3.1.1ï¼‰ã€‚</p><p>ä½†æ˜¯å°èŠ±è·‘é¡¹ç›®çš„æ—¶å€™ï¼Œå°±å¯èƒ½æ˜¯Aï¼ˆ1.0.0ï¼‰Bï¼ˆ3.2.9ï¼‰ã€‚</p><p>è¿™æ—¶ç¯å¢ƒå°±ä¸ä¸€è‡´äº†ã€‚</p><p>æ‰€ä»¥è¿˜æ˜¯å¾—ç”¨ <code>Podfile.lock</code> ï¼Œè·‘å®ŒæŠŠ <code>Podfile.lock</code> ä¸€èµ·æäº¤ä¸Šå»ï¼Œå¤§å®¶ç”¨çš„å°±éƒ½æ˜¯åŒä¸€å¥—ç¯å¢ƒäº†ã€‚</p><h1 id="é™¤äº†-CocoaPodsï¼Œè¿˜æœ‰å“ªäº›é€‰é¡¹ï¼Ÿ"><a href="#é™¤äº†-CocoaPodsï¼Œè¿˜æœ‰å“ªäº›é€‰é¡¹ï¼Ÿ" class="headerlink" title="é™¤äº† CocoaPodsï¼Œè¿˜æœ‰å“ªäº›é€‰é¡¹ï¼Ÿ"></a>é™¤äº† CocoaPodsï¼Œè¿˜æœ‰å“ªäº›é€‰é¡¹ï¼Ÿ</h1><p><strong>Carthage</strong>ã€‚å¦‚æœè¯´ CocoaPods æ˜¯ä¸€ä¸ªå‚»ç“œå¼çš„ä¸€é”®å·¥å…·ï¼Œé‚£ä¹ˆ Carthage å°±æ˜¯æ›´è½»é‡çº§çš„ã€è‡ªå®šä¹‰çš„ï¼Œæ›´çµæ´»çš„ï¼Œå…·ä½“ä¼˜ç‚¹æ˜¯ï¼š</p><h2 id="ä¸ä¾µå…¥æ€§"><a href="#ä¸ä¾µå…¥æ€§" class="headerlink" title="ä¸ä¾µå…¥æ€§"></a>ä¸ä¾µå…¥æ€§</h2><p>Carthage åšçš„å·¥ä½œä»…ä»…æ˜¯ä¸‹è½½ pod æºç ä»¥åŠç”¨ xcodebuild å·¥å…·æŠŠæºç ç¼–è¯‘æˆframeworksï¼ˆä»…æ”¯æŒåŠ¨æ€åº“ï¼‰ã€‚éœ€è¦å¼€å‘è€…æ‰‹åŠ¨å°†å¯¹åº”çš„ framework é“¾æ¥åˆ°é¡¹ç›®ä¸­ã€‚</p><h2 id="çµæ´»æ€§"><a href="#çµæ´»æ€§" class="headerlink" title="çµæ´»æ€§"></a>çµæ´»æ€§</h2><p>æ­£å¼å› ä¸º Carthage çš„ä¸ä¾µå…¥æ€§ï¼Œæ‰€ä»¥å®ƒä¸ä¼šåƒ CocoaPods ä¸€æ ·ä¼šå½±å“åŸé¡¹ç›®çš„ç»“æ„ã€‚è¿™è®©å®ƒ<strong>å®¹æ˜“é›†æˆ</strong>ï¼Œä¹Ÿ<strong>å®¹æ˜“å»é™¤</strong>ã€‚</p><h2 id="å»ä¸­å¿ƒåŒ–"><a href="#å»ä¸­å¿ƒåŒ–" class="headerlink" title="å»ä¸­å¿ƒåŒ–"></a>å»ä¸­å¿ƒåŒ–</h2><p>Carthage æ²¡æœ‰ CocoaPods ä¸€æ ·çš„ä¸­å¿ƒæœåŠ¡å™¨ï¼Œå¦‚æœè¦æ›´æ–°ç¯å¢ƒæˆ–è€…é…ç½®æŸä¸ª pod æ—¶ï¼Œç›´æ¥æ›´æ–°å¯¹åº” podï¼Œä¸éœ€è¦å‘ä¸­å¿ƒæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚</p><h2 id="ç¼–è¯‘é€Ÿåº¦å¿«"><a href="#ç¼–è¯‘é€Ÿåº¦å¿«" class="headerlink" title="ç¼–è¯‘é€Ÿåº¦å¿«"></a>ç¼–è¯‘é€Ÿåº¦å¿«</h2><p>ä½¿ç”¨äº†CocoaPodsçš„é¡¹ç›®ï¼Œæ¸…ç¼“å­˜åé‡æ–°ç¼–è¯‘ï¼Œéœ€è¦æŠŠæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“ç¼–è¯‘ä¸€éã€‚è€Œå› ä¸º Carthage æ˜¯å·²ç»æŠŠç¬¬ä¸‰æ–¹åº“ç¼–è¯‘æˆäº†frameworksäº†ï¼Œäºæ˜¯ä¸éœ€è¦å†ä¸€æ¬¡ç¼–è¯‘ç¬¬ä¸‰æ–¹åº“ã€‚</p><hr><p>å½“ç„¶ï¼ŒCarthage ä¸æ˜¯æ²¡æœ‰<strong>ç¼ºç‚¹ï¼š</strong></p><h2 id="çœ‹ä¸åˆ°æºç "><a href="#çœ‹ä¸åˆ°æºç " class="headerlink" title="çœ‹ä¸åˆ°æºç "></a>çœ‹ä¸åˆ°æºç </h2><p>ä»¥ framework æ–¹æ³•å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åº“åœ¨ Xcode ä¸­åªèƒ½çœ‹åˆ°å¤´æ–‡ä»¶ï¼Œè€Œä¸èƒ½ç›´æ¥çœ‹åˆ°æºä»£ç ã€‚</p><h2 id="æ‰‹åŠ¨æ“ä½œå¤šï¼Œå®¹æ˜“å‡ºé—®é¢˜"><a href="#æ‰‹åŠ¨æ“ä½œå¤šï¼Œå®¹æ˜“å‡ºé—®é¢˜" class="headerlink" title="æ‰‹åŠ¨æ“ä½œå¤šï¼Œå®¹æ˜“å‡ºé—®é¢˜"></a>æ‰‹åŠ¨æ“ä½œå¤šï¼Œå®¹æ˜“å‡ºé—®é¢˜</h2><ul><li>éœ€è¦å¼€å‘è€…è‡ªå·±å°†ç¼–è¯‘å¥½çš„xcframeworkæ–‡ä»¶æ‹–è¿›é¡¹ç›®ä¸­ï¼ŒåŒæ—¶è®¾ç½®å¯¹åº”å±æ€§ã€‚</li></ul><hr><h1 id="Carthage-or-CocoaPodså¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¬¬ä¸‰æ–¹åº“ç®¡ç†å·¥å…·ï¼Ÿ"><a href="#Carthage-or-CocoaPodså¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¬¬ä¸‰æ–¹åº“ç®¡ç†å·¥å…·ï¼Ÿ" class="headerlink" title="Carthage or CocoaPodså¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¬¬ä¸‰æ–¹åº“ç®¡ç†å·¥å…·ï¼Ÿ"></a>Carthage or CocoaPodså¦‚ä½•é€‰æ‹©åˆé€‚çš„ç¬¬ä¸‰æ–¹åº“ç®¡ç†å·¥å…·ï¼Ÿ</h1><p>åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ï¼ŒCarthage å’Œ CocoaPods ä¸æ˜¯ã€Œä¸€å±±ä¸å®¹äºŒè™ã€çš„å…³ç³»ï¼Œå®ƒä»¬å¯ä»¥æ··ç”¨ã€‚å†åŠ ä¸Šè€ƒè™‘CocoaPods å¯¹é¡¹ç›®çš„ä¾µå…¥æ€§ï¼Œä¸€ç§æ˜¾è€Œæ˜“è§çš„ç­–ç•¥æ˜¯ï¼š</p><p>å…ˆä½¿ç”¨ Carthageï¼Œå½“å‘ç°Carthage æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼ˆä¾‹å¦‚æŸ¥çœ‹æºç ï¼Œç¬¬ä¸‰æ–¹åº“åªæ”¯æŒ CocoaPodsç­‰ï¼‰ï¼Œå†ä½¿ç”¨ CocoaPodsã€‚</p><hr><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://www.codetd.com/article/13754374#:~:text=CocoaPods%20%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E5%B0%86%E6%89%80%E6%9C%89%E7%9A%84%E4%BE%9D%E8%B5%96%E5%BA%93%E9%83%BD%E6%94%BE%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAPods%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD%EF%BC%8C%E7%84%B6%E8%80%8C%E8%AE%A9%E4%B8%BB%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96Pods%E9%A1%B9%E7%9B%AE%EF%BC%8C%20%E8%BF%99%E6%A0%B7%EF%BC%8C%E6%BA%90%E7%A0%81%E7%AE%A1%E7%90%86%E5%B7%A5%E4%BD%9C%E4%BB%BB%E5%8A%A1%E4%BB%8E%E4%B8%BB%E9%A1%B9%E7%9B%AE%E7%A7%BB%E5%88%B0%E4%BA%86Pods%E9%A1%B9%E7%9B%AE%E4%B8%AD%E3%80%82,1.%20Pods%E9%A1%B9%E7%9B%AE%E6%9C%80%E7%BB%88%E4%BC%9A%E7%BC%96%E8%AF%91%E6%88%90%E4%B8%80%E4%B8%AA%E5%90%8D%E4%B8%BAlibPods.a%E7%9A%84%E6%96%87%E4%BB%B6,%20%E4%B8%BB%E9%A1%B9%E7%9B%AE%E5%8F%AA%E8%A6%81%E4%BE%9D%E8%B5%96%E8%BF%99%E4%B8%AA.a%E6%96%87%E4%BB%B6%E5%8D%B3%E5%8F%AF" title="iOS-CocoaPodsçš„åŸç†åŠPodfile.locké—®é¢˜">iOS-CocoaPodsçš„åŸç†åŠPodfile.locké—®é¢˜</a></li><li><a href="https://www.objc.io/issues/6-build-tools/cocoapods-under-the-hood/" title="CocoaPods Under The Hood">CocoaPods Under The Hood</a></li><li><a href="https://semver.org/" title="Semantic Versioning 2.0.0">Semantic Versioning 2.0.0</a>ï¼Œ <a href="https://www.jianshu.com/p/e2619a7aa60e" title="ä¸­æ–‡ç¿»è¯‘">ä¸­æ–‡ç¿»è¯‘</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>iOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hummer çš„é€šä¿¡æœºåˆ¶</title>
    <link href="/2022/07/25/Hummer%E7%9A%84%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/"/>
    <url>/2022/07/25/Hummer%E7%9A%84%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<p>â€”â€” ä¸€ä¸ªè·¨ç«¯æ¡†æ¶åº”è¯¥è¦æ€ä¹ˆé€šä¿¡ï¼Ÿ</p><p>ä¸–ç•Œä¸Šæœ‰å¾ˆå¤šè·¨ç«¯æ¡†æ¶ï¼Œæœ‰è‡ªå·±æŠŠåº•å±‚æ¸²æŸ“çš„å·¥ä½œéƒ½åŒ…äº†çš„ï¼Œé‚£ä¸ªå« Flutterï¼Œæœ‰é‚£ç§æŠŠå°ç¨‹åºè£…è¿› Appï¼Œç”¨ Webview æå®šé¡µé¢çš„ï¼Œç”¨å°ç¨‹åºæ¡†æ¶æ¥å®ç°è·¨ç«¯çš„ï¼Œè¿™ä¸ªæ»´æ»´å†…éƒ¨è‡ªç ”æœ‰ä¸€ä¸ªï¼Œå«<strong>æ˜Ÿæ²³</strong>ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ›´ä¸ºå¸¸è§ï¼Œå°±æ˜¯åœ¨ Android å’Œ iOS éƒ½å®ç°ä¸€å¥— UIå’ŒåŸºç¡€ç±»ï¼Œç„¶åå¼€å‘è€…åªéœ€è¦ç¼–å†™ä¸€å¥—ä¸šåŠ¡ä»£ç å°±èƒ½ç»™ä¸¤ç«¯ç”¨ï¼Œè¿™ç§æœ‰ReactNativeï¼ŒWeexï¼Œè¿˜æœ‰ä»Šå¤©æˆ‘è¦è¯´çš„ Hummerã€‚</p><hr><p>åœ¨å¼€å‘éœ€æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›é—®é¢˜å¸¸å¸¸è¦ç»•åœ¨æˆ‘çš„å¤´è„‘ä¸­ï¼š</p><p><strong>åœ¨ Native ä¾§éœ€è¦åšä»€ä¹ˆå·¥ä½œï¼Œæ‰èƒ½æŠŠTypeScript ä»£ç è¿è¡Œèµ·æ¥ï¼Ÿ</strong></p><p>æˆ–è€…é—®å¾—æ›´å…·ä½“ç‚¹ï¼š</p><p><strong>ä¸€ä¸ª Hello world çš„æ–‡å­—æ€ä¹ˆæ‰èƒ½é€šè¿‡å‡ è¡Œ TypeScript ä»£ç ï¼Œå°±èƒ½æ˜¾ç¤ºåˆ°æ‰‹æœºå±å¹•ä¸Šï¼Ÿ</strong></p><hr><h1 id="åˆå§‹åŒ–Hummerï¼šå®‰è£…å¼•æ“"><a href="#åˆå§‹åŒ–Hummerï¼šå®‰è£…å¼•æ“" class="headerlink" title="åˆå§‹åŒ–Hummerï¼šå®‰è£…å¼•æ“"></a>åˆå§‹åŒ–Hummerï¼šå®‰è£…å¼•æ“</h1><p><img src="/../image/install_engine.png"></p><p>åƒæ±½è½¦ä¸€æ ·ï¼Œæƒ³è®©Hummerè¿è¡Œï¼Œè½¦å­å…ˆè¦æœ‰å¼•æ“</p><div class="code-wrapper"><pre><code class="hljs objective-c">[Hummer startEngine:nil];</code></pre></div><p>è¿™è¡Œä»£ç åšäº†ä»€ä¹ˆï¼Ÿ</p><ol><li><p>åŠ è½½æ‰€æœ‰<strong>å·²ç»å¯¼å‡ºçš„ç±»</strong></p><blockquote><p>ä»€ä¹ˆå«ã€Œå¯¼å‡ºçš„ç±» Exported Classã€ï¼ŸæŒ‡çš„æ˜¯é‚£äº›åœ¨ Native ä¾§å·²ç»å†™å¥½äº†ï¼ŒTypeScript ä»£ç å¯ä»¥ä½¿ç”¨çš„ç±»ã€‚å¯¼å‡ºçš„æ–¹æ³•ï¼Œå¯¼å‡ºçš„å±æ€§åŒç†ã€‚</p></blockquote><blockquote><p>é‚£ä»€ä¹ˆå«<strong>åŠ è½½</strong>å‘¢ï¼Ÿå°±æ˜¯æŠŠè¿™äº›Native ç±»èµ·ä¸€ä¸ªobjc çš„ç±»åï¼Œå†èµ·ä¸€ä¸ª js ç±»åï¼Œç„¶åæ”¾å…¥ä¸€ä¸ª dictionary ä¸­ï¼Œè¿™æ ·æ—¢å¯ä»¥é€šè¿‡ objc ç±»åè·å–åˆ°è¿™ä¸ªç±»ï¼Œä¹Ÿèƒ½é€šè¿‡ js ç±»åè·å–åˆ°è¿™ä¸ªç±»ã€‚ä¸€ç±»ï¼Œä¸¤åã€‚å°±åƒç»™æˆ‘å®¶çš„ä»†äººèµ·ä¸€ä¸ªä¸­æ–‡åç›ä¸½ï¼Œèµ·ä¸€ä¸ªè‹±æ–‡å Maryï¼Œé‚£æ—¢å¯ä»¥é€šè¿‡ã€Œç›ä¸½ã€å‘¼å”¤å¥¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ã€ŒMaryã€å‘¼å”¤å¥¹ã€‚</p></blockquote></li><li><p>åŠ è½½æ‰€æœ‰<strong>å¯¼å‡ºçš„æ–¹æ³•å’Œå±æ€§</strong></p></li><li><p>ç¡®å®šå¯¼å‡ºç±»çš„çˆ¶ç±»å…³ç³»</p><p>æ¯”å¦‚æˆ‘ä»¬å·²ç»åŠ è½½äº† ABCD å››ä¸ªå¯¼å‡ºç±»ï¼Œé‚£å…¶ä¸­çš„ A ç±»å¯èƒ½æ˜¯ç»§æ‰¿B ç±»çš„ï¼Œé‚£ä¹ˆå°±è¦æŠŠè¿™ä¸ªçˆ¶ç±»å…³ç³»ç»™è®°å½•ä¸‹æ¥ï¼Œè®°å½•åœ¨ A ç±»çš„superClassReferenceå±æ€§ä¸­å³å¯ï¼ˆæ³¨æ„è¿™é‡Œç¡®å®šçš„ æ˜¯jsç»„ä»¶çš„ç»§æ‰¿å…³ç³»ï¼Œæ¯”å¦‚ Text ç»§æ‰¿è‡ª Viewï¼‰</p></li></ol><p>ç‚¹ç«çš„ç»“æœæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª HMExportManager ï¼Œå®ƒé‡Œè¾¹æœ‰è®¸è®¸å¤šå¤šåŠ è½½å¥½çš„<strong>ç±»ã€æ–¹æ³•å’Œå±æ€§</strong>ã€‚è¿™æ—¶Hummer å·²ç»æœ‰äº†åŠ¨åŠ›æ¥æºäº†ã€‚</p><h2 id="å¥½åƒå¿˜äº†ç‚¹ä¸œè¥¿ï¼Ÿ"><a href="#å¥½åƒå¿˜äº†ç‚¹ä¸œè¥¿ï¼Ÿ" class="headerlink" title="å¥½åƒå¿˜äº†ç‚¹ä¸œè¥¿ï¼Ÿ"></a>å¥½åƒå¿˜äº†ç‚¹ä¸œè¥¿ï¼Ÿ</h2><p>åœ¨å¼€å§‹çš„å¼€å§‹ï¼Œ<strong>å¯¼å‡ºç±»æ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ</strong> æˆ‘æ²¡æœ‰å†™å¯¼å‡ºçš„ä»£ç ï¼Œé‚£ä¸€å®šæ˜¯Hummer è‡ªå·±å†™çš„ï¼Œç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿåœ¨è¿™é‡Œï¼ˆæˆ‘ä»¬éšä¾¿æ‰¾ä¸ªç±»ï¼‰</p><p><img src="/../image/export.png"></p><p>ç‚¹è¿›å»çœ‹å®ç°ï¼š</p><p>ç”¨åˆ°äº†__attribute__((section(â€œnameâ€))) ,è¿™ä¸ªç¼–è¯‘å±æ€§ï¼Œæ”¹å˜äº†æ•°æ®çš„å­˜å‚¨ç‰¹æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´é€šè¿‡é­”æ³•ä¸€èˆ¬çš„ä»£ç ï¼Œæˆ‘ä»¬å¾—ä»¥åœ¨ç¼–è¯‘é“¾æ¥çš„æ—¶å€™å°±æŠŠå¯¹åº”çš„ç»“æ„ä½“ï¼ˆä¹Ÿå°±æ˜¯ HMExportStructï¼‰å†™åˆ°å¯æ‰§è¡Œæ–‡ä»¶ Mach-O ä¸­ï¼Œåœ¨åç»­çš„åˆå§‹åŒ–ä»£ç ä¸­èƒ½è¯»å‡ºæ¥ã€‚</p><blockquote><p><a href="https://developer.arm.com/documentation/dui0474/g/using-scatter-files/using---attribute----section--name-----to-place-code-and-data" title="ARM æ–‡æ¡£">ARM æ–‡æ¡£</a>åœ¨è¿™é‡Œï¼Œæœ‰å…´è¶£å°±ç‚¹å»çœ‹çœ‹å§ã€‚<br>used å‚æ•°æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨ï¼šä¸ç®¡æˆ‘ç”¨ä¸ç”¨éƒ½<strong>ä¸éœ€è¦</strong>ä¼˜åŒ–æ‰è¿™ä¸ªå‡½æ•°ã€‚è¿™é‡Œ<a href="https://www.jianshu.com/p/6fc9974f515a" title="æœ‰ä¸€ç¯‡æ–‡ç« ">æœ‰ä¸€ç¯‡æ–‡ç« </a>è®²äº†æ€ä¹ˆä½¿ç”¨è¿™ä¸ªç¼–è¯‘å±æ€§</p></blockquote><p><strong>äºæ˜¯æˆ‘ä»¬çš„ç–‘æƒ‘å¾—ä»¥è§£å¼€äº†ï¼š</strong></p><blockquote><p>ä¸¾ä¸ª<strong>æ —å­</strong>ğŸŒ°ç»™è§‚ä¼—æœ‹å‹ä»¬æ•´æ˜ç™½ç‚¹ï¼š<br>æˆ‘ä»¬åœ¨ .m æ–‡ä»¶ä¸­å†™ä¸‹ HM_EXPORT_CLASS(Loading, HMActivityIndicatorView)ï¼Œ<br>å°±è¶³ä»¥è®©ç¼–è¯‘å™¨æŠŠå¯¹åº”çš„ __hm_export_class_Loding__ ç»“æ„ä½“å†™åˆ° Mach-O æ–‡ä»¶ä¸­ï¼Œæœ€ååœ¨startEngine çš„æ—¶å€™å°±èƒ½è·å–åˆ°å¯¹åº”çš„å¯¼å‡ºç±»ã€‚</p></blockquote><h1 id="å‡†å¤‡æ§åˆ¶å™¨ï¼šæ‰§è¡Œ-JS-ä»£ç çš„å¿…è¦æ¡ä»¶"><a href="#å‡†å¤‡æ§åˆ¶å™¨ï¼šæ‰§è¡Œ-JS-ä»£ç çš„å¿…è¦æ¡ä»¶" class="headerlink" title="å‡†å¤‡æ§åˆ¶å™¨ï¼šæ‰§è¡Œ JS ä»£ç çš„å¿…è¦æ¡ä»¶"></a>å‡†å¤‡æ§åˆ¶å™¨ï¼šæ‰§è¡Œ JS ä»£ç çš„å¿…è¦æ¡ä»¶</h1><p>é€šè¿‡ startEngineï¼Œæˆ‘ä»¬çš„ Hummer é¡¹ç›®åœ¨å®¢è§‚ä¸Šæœ‰äº†ä¸Šè·¯å¥”é©°çš„èƒ½åŠ›ï¼Œä½†æ˜¯ï¼Œè¿˜æ²¡æœ‰ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œæ²¡æœ‰æ²¹é—¨ã€æ–¹å‘ç›˜ã€æ¢æŒ¡æ†ç­‰ä¸€ç³»åˆ—è·Ÿè½¦å­äº¤æµçš„èƒ½åŠ›ï¼Œæˆ‘ä»¬æ— æ³•ï¼ˆ<strong>ä» JS ä¾§</strong>ï¼‰æ§åˆ¶Hummeræ¡†æ¶ã€‚</p><p><img src="/../image/driver.png"></p><p>æ‰€ä»¥è¿™æ—¶æˆ‘ä»¬è¿˜éœ€è¦åˆå§‹åŒ–è¿™ä¸ªã€Œ<strong>ä¸­é—´è€…</strong>ã€ï¼Œå®ƒå°±æ˜¯ï¼š</p><p><strong>HMJSContext</strong>ï¼š<strong>è·¨ç«¯å±‚</strong>ï¼Œè´Ÿè´£ Native å’Œ JS ä¹‹é—´çš„é€šä¿¡ã€‚</p><div class="code-wrapper"><pre><code class="hljs objective-c">// HMViewController.m- (void)renderWithScript:(NSString *)script &#123;   ...    //æ¸²æŸ“è„šæœ¬ä¹‹å‰ éœ€è¦æ³¨å†Œbridge    HMJSContext *context = [HMJSContext contextInRootView:self.hmRootView];    self.context = context;   ...        //æ‰§è¡Œè„šæœ¬    [context evaluateScript:script fileName:self.URL];   ...&#125;</code></pre></div><p>åˆå§‹åŒ– HMJSContext ï¼Œæœ‰äº”ä»¶äº‹æƒ…è¦åš</p><ol><li><p>è¯»å– Hummer bundle æ–‡ä»¶ä¸­çš„ builtin.js æ–‡ä»¶</p></li><li><p><strong>åˆå§‹åŒ– HMJSCExecutorï¼ˆè¿™ä¸ªæ˜¯ context çš„æ ¸å¿ƒï¼Œä½œç”¨åé¢è®²ï¼‰</strong></p></li><li><p><strong>æ‰§è¡Œ builtin.js</strong></p></li><li><p>æŠŠ Native ç«¯çš„ç±»ä¿¡æ¯ï¼ˆstartEngine çš„æ—¶å€™ç”Ÿæˆçš„ï¼‰ï¼ŒåŒ…è£…æˆ JS å…¼å®¹çš„æ ¼å¼</p></li><li><p>æŠŠä¸Šé¢åŒ…è£…çš„ä¿¡æ¯æ³¨å†Œåˆ° JS ä¾§</p></li></ol><p>&amp;#x20;å…ˆåšä¸ªç»“è®ºï¼š<strong>HMJSContext åˆå§‹åŒ–ä¹‹åï¼Œè½¦å­å°±æœ‰äº†æ–¹å‘ç›˜ï¼Œå°±æœ‰äº†ç‚¹ç«å™¨ï¼Œå°±æœ‰äº†æ²¹é—¨ï¼Œæœ‰äº†ä¸€åˆ‡è¯¥æœ‰çš„ï¼Œåªè¦æ¥ä¸ªäººå°±èƒ½æŠŠè¿™è¾†è½¦å¼€èµ·æ¥äº†ã€‚</strong></p><hr><p>ç„¶åæˆ‘ä»¬å†ç»†çœ‹è¿™äº”ä»¶äº‹æƒ…ã€‚è™½ç„¶æœ‰äº”ä»¶ï¼Œä½†æ˜¯åªæœ‰ä¸¤ä»¶äº‹éœ€è¦è¯´</p><ul><li><p>åˆå§‹åŒ– HMJSCExecutor</p></li><li><p>æ‰§è¡Œ builtin.js</p></li></ul><p>å¯ä»¥æŠŠHMJSCExecutor çœ‹åšæ˜¯HMJSContextçš„<strong>æ‰“æ‰‹</strong>ï¼Œå«¡ç³»ï¼Œæ ¸å¿ƒä¸‹å±ï¼Œå› ä¸ºExecutorï¼Œå¬åå­—å°±çŸ¥é“ï¼Œå°±æ˜¯è´Ÿè´£ executeçš„ï¼Œ<strong>ã€Œæ‰§è¡Œ JS ä»£ç ï¼Œä»¥åŠç›‘å¬ JS è°ƒç”¨ Native çš„å›è°ƒã€‚ã€</strong></p><p>æ¥çœ‹çœ‹å®ƒçš„åˆå§‹åŒ–å‡½æ•°</p><div class="code-wrapper"><pre><code class="hljs objective-c">- (instancetype)init &#123;...    // å…±ç”¨ä¸€ä¸ª JS ç¯å¢ƒ    if (!virtualMachineRef) &#123;        virtualMachineRef = JSContextGroupCreate();    &#125;...    [HMExecutorMap setObject:self forKey:[NSValue valueWithPointer:_contextRef]];    // æ³¨å…¥å¯¹è±¡        // ç”Ÿæˆ JS å­—ç¬¦ä¸²    JSStringRef hummerCallString = JSStringCreateWithUTF8CString(&quot;hummerCall&quot;);    JSStringRef hummerCreateString = JSStringCreateWithUTF8CString(&quot;hummerCreate&quot;);    ...    JSObjectRef globalThis = JSContextGetGlobalObject(_contextRef);    // åˆ›å»º C å‡½æ•°çš„ bridge    JSObjectRef nativeLoggingHookFunction = JSObjectMakeFunctionWithCallback(_contextRef, NULL, &amp;nativeLoggingHook);    JSObjectRef inlineHummerCallFunction = JSObjectMakeFunctionWithCallback(_contextRef, NULL, &amp;hummerCall);    ...    JSValueRef exception = NULL;        // æŠŠ bridge ç»‘å®šåˆ° JS ç¯å¢ƒçš„ Global å¯¹è±¡ä¸Š, åé¢å¯ä»¥é€šè¿‡ globalThis.method() æ¥è°ƒç”¨è¿™é‡Œç»‘å®šå¥½çš„å‡½æ•°    JSObjectSetProperty(_contextRef, globalThis, nativeLoggingHookStringRef, nativeLoggingHookFunction, kJSPropertyAttributeReadOnly | kJSPropertyAttributeDontDelete, &amp;exception);    JSObjectSetProperty(_contextRef, globalThis, hummerCallString, inlineHummerCallFunction, kJSPropertyAttributeReadOnly | kJSPropertyAttributeDontDelete, &amp;exception);    ...&#125;</code></pre></div><blockquote><p>JSObjectMakeFunctionWithCallbackï¼šæŠŠ C å‡½æ•°çš„ callback æ³¨å†Œåˆ° JS ä¾§ï¼Œæ¯”å¦‚JS è°ƒç”¨hummerCallæ—¶ï¼Œå°±ä¼šç›´æ¥è°ƒç”¨ C å‡½æ•°ã€ŒhummerCallã€</p></blockquote><p>ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼šæ³¨å†Œäº†ä¸€äº› <strong>C å‡½æ•°</strong>ç»™ JSã€‚</p><hr><p>ç­‰ç­‰ï¼Œå†™åˆ°è¿™å„¿æˆ‘å·²ç»æœ‰ç‚¹è¿·ç³Šäº†ï¼Œç®€å•æ¦‚æ‹¬ä¸€ä¸‹</p><p><strong>Hummer æœ‰äº†å¼•æ“ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªHMJSContextæ¥æ§åˆ¶å®ƒï¼Œäºæ˜¯å°±å¾—å»åˆå§‹åŒ–è¿™ç©æ„å„¿ï¼šåˆ›å»ºä¸€ä¸ªHMJSCExecutorï¼Œæ³¨å†Œäº†ä¸€äº› C å‡½æ•°ç»™ JSã€‚</strong></p><p>OKï¼Œæˆ‘ä»¬ç»§ç»­ã€‚</p><p>é‚£æ¥ä¸‹æ¥å°±æ˜¯è¯´è¯´æ³¨å†Œçš„éƒ½æ˜¯äº›ä»€ä¹ˆå‡½æ•°ï¼Ÿ</p><ol><li><p>hummerCallï¼šjs ä¾§è°ƒç”¨ Nativeæ–¹æ³•ï¼ˆç±»æ–¹æ³•å’Œæˆå‘˜æ–¹æ³•ï¼‰</p></li><li><p>hummerCreateï¼šåˆ›å»ºNativeå¯¹è±¡ï¼Œå¹¶è¿”å› js æŒ‡é’ˆæ¥æŒæœ‰è¿™ä¸ªå¯¹è±¡</p></li><li><p>hummerGetPropertyï¼šï¼ˆè·å–å¯¹è±¡çš„å±æ€§å€¼ï¼‰</p></li><li><p>hummerSetPropertyï¼šï¼ˆè®¾ç½®å¯¹è±¡çš„å±æ€§å€¼ï¼‰</p></li><li><p>hummerCallFunctionï¼šï¼ˆè°ƒç”¨é—­åŒ…å‡½æ•° closureï¼‰</p></li></ol><blockquote><p>è¿™äº”ä¸ªå‡½æ•°ï¼Œéƒ½ä¼šåœ¨æ‰§è¡Œ builtin.js æ–‡ä»¶çš„æ—¶å€™ä½¿ç”¨åˆ°ã€‚æ‰€ä»¥æ³¨æ„çœ‹index.tsï¼ŒHummerBase.tsï¼ŒinjectClassModel.tsè¿™å‡ ä¸ªæ–‡ä»¶</p></blockquote><p>ä¸ç®¡æ˜¯hummerCall è¿˜æ˜¯hummerGetPropertyã€hummerSetPropertyï¼Œä»–ä»¬éƒ½è°ƒç”¨äº†ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š</p><div class="code-wrapper"><pre><code class="hljs objective-c">- (JSValueRef)hummerGetSetPropertyWithArgumentCount:(size_t)argumentCount                                           arguments:(const JSValueRef _Nonnull[])arguments                                            isSetter:(BOOL)isSetter &#123;                          1. åˆ¤æ–­æ˜¯ç±»æ–¹æ³•è¿˜æ˜¯æˆå‘˜æ–¹æ³•    2. æ ¹æ® arguments è·å–åˆ° target, method å’Œ methodSignature    3. ç»„è£…æˆ NSInvocation å¹¶è½¬å‘æ¶ˆæ¯    4. è¿”å›ç»“æœ                &#125;</code></pre></div><p><strong>è¿™å°±æ˜¯ HMJSCExecutor çš„åˆå§‹åŒ–å·¥ä½œã€‚</strong></p><hr><h3 id="åˆå§‹åŒ–-HMJSContext-çš„ç¬¬äºŒä»¶å€¼å¾—ä¸€è¯´çš„äº‹"><a href="#åˆå§‹åŒ–-HMJSContext-çš„ç¬¬äºŒä»¶å€¼å¾—ä¸€è¯´çš„äº‹" class="headerlink" title="åˆå§‹åŒ– HMJSContext çš„ç¬¬äºŒä»¶å€¼å¾—ä¸€è¯´çš„äº‹"></a>åˆå§‹åŒ– HMJSContext çš„ç¬¬äºŒä»¶å€¼å¾—ä¸€è¯´çš„äº‹</h3><p>æ‰§è¡Œ builtin.jsã€‚</p><p>æ‰¾ä¸€ä¸‹ï¼Œå‘ç°åœ¨è¿™å„¿</p><p><img src="/../image/built.png"></p><p>ä½†æ˜¯è¿™ä¸ªæ‰“å¼€ä¸€çœ‹ï¼Œæ‚¨çŒœæ€ä¹ˆç€ï¼Ÿæ··æ·†è¿‡çš„ï¼Œçœ‹ä¸äº†ã€‚é‚£æ€ä¹ˆåŠå‘¢ï¼ŸæŠŠ Hummer å·¥ç¨‹ä¸€æ•´ä¸ª clone ä¸‹æ¥ï¼Œæ•´è¿™ä¸ªè·¯å¾„ï¼šHummer&#x2F;iOS&#x2F;builtin&#x2F;src&#x2F;ã€‚</p><p>åº•ä¸‹æœ‰è‹¥å¹²ä¸ªæ–‡ä»¶ï¼Œæ®å¯é æ¶ˆæ¯ï¼Œè¿™å‡ ä¸ªæ–‡ä»¶å°±æ˜¯æ··æ·†åçš„ builtin.js æ–‡ä»¶</p><h4 id="index-ts"><a href="#index-ts" class="headerlink" title="index.ts"></a>index.ts</h4><p>è¿™ä¸ªæ–‡ä»¶æ˜¯ç»™ globalThis æ³¨å†Œå¾ˆå¤šæ–¹æ³•ï¼Œä½†æ˜¯<strong>æ²¡æœ‰è°ƒç”¨</strong>ï¼Œæ¯”å¦‚<strong>hummerLoadClass <strong>ï¼ˆè¿™ä¸ªæ˜¯ä¸ªéå¸¸é‡è¦çš„æ–¹æ³•ï¼Œæ‰§è¡Œå®Œäº† builtin.js åï¼ŒNative ä¾§åˆ</strong>ç‰¹åœ°è°ƒç”¨</strong>äº†è¿™ä¸ª <strong>hummerLoadClass</strong>ï¼Œåœ¨HMJSContext#init ï¼‰</p><blockquote><p><strong>hummerLoadClass</strong> çš„ä½œç”¨æ˜¯ï¼š<strong>å°†Nativeå¯¼å‡ºç±»çš„ä¿¡æ¯å…¨éƒ¨æ³¨å†Œåˆ° JS ä¾§</strong>ã€‚å…¥å‚å°±æ˜¯ä¸€ä¸ª JSON å­—ç¬¦ä¸²ï¼Œåœ¨HMJSContext#init() çš„å€’æ•°ç¬¬äºŒè¡Œå¯ä»¥çœ‹åˆ°å…·ä½“çš„æ‰§è¡Œä»£ç </p></blockquote><h4 id="HummerBase-ts"><a href="#HummerBase-ts" class="headerlink" title="HummerBase.ts"></a>HummerBase.ts</h4><p>æ®è¯´æ˜¯æ‰€æœ‰æ³¨å†Œåˆ° js ä¾§çš„ç±»çš„åŸºç±»</p><h4 id="injectClassModel-ts"><a href="#injectClassModel-ts" class="headerlink" title="injectClassModel.ts"></a>injectClassModel.ts</h4><p>ä¸Šé¢çš„<strong>hummerLoadClass</strong> æ³¨å†Œä¿¡æ¯æ—¶ï¼Œå¾ªç¯è°ƒç”¨<strong>injectClassModel</strong> æ–¹æ³•æ¥å®Œæˆæ³¨å†Œçš„ã€‚è°ƒç”¨ä¸€æ¬¡ï¼Œæ³¨å†Œä¸€ä¸ªå¯¼å‡ºç±»çš„ä¿¡æ¯ã€‚</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">injectClassModel</span>(<span class="hljs-params">jsClassName: string, classModel: ClassModel, classModelMap: Record&lt;string, ClassModel | <span class="hljs-literal">undefined</span> | <span class="hljs-literal">null</span>&gt;</span>): <span class="hljs-keyword">typeof</span> <span class="hljs-title class_">HummerBase</span> | <span class="hljs-literal">undefined</span> &#123;    <span class="hljs-keyword">let</span> jsClass = <span class="hljs-title class_">HummerBase</span>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isNotEmptyString</span>(classModel.<span class="hljs-property">superClassName</span>) &amp;&amp; classModelMap[classModel.<span class="hljs-property">superClassName</span>]) &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> globalThis[classModel.<span class="hljs-property">superClassName</span>] !== <span class="hljs-string">&#x27;function&#x27;</span>) &#123;            <span class="hljs-comment">//  0. æœ‰çˆ¶ç±»å¹¶ä¸”çˆ¶ç±»æ²¡æœ‰æ³¨å…¥åˆ™å…ˆæ³¨å…¥çˆ¶ç±»</span>            <span class="hljs-keyword">const</span> innerLoaderClassModel = classModelMap[classModel.<span class="hljs-property">superClassName</span>]            <span class="hljs-keyword">if</span> (innerLoaderClassModel) &#123;                <span class="hljs-keyword">const</span> superClass = <span class="hljs-title function_">injectClassModel</span>(classModel.<span class="hljs-property">superClassName</span>, innerLoaderClassModel, classModelMap)                <span class="hljs-keyword">if</span> (superClass) &#123;                    jsClass = superClass                &#125;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            jsClass = globalThis[classModel.<span class="hljs-property">superClassName</span>]        &#125;    &#125;    jsClass = <span class="hljs-keyword">class</span> <span class="hljs-title class_">extends</span> jsClass &#123; &#125;    classModel.<span class="hljs-property">methodPropertyList</span>?.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">methodPropertyModel</span> =&gt;</span> &#123;        <span class="hljs-comment">// è¿™é‡Œæ˜¯é‡ç‚¹ï¼Œä½†æ˜¯æ²¡çœ‹æ‡‚</span>        <span class="hljs-keyword">const</span> prototypeOrClsss = methodPropertyModel.<span class="hljs-property">isClass</span> ? jsClass : jsClass.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>        <span class="hljs-comment">// æ³¨å…¥æ–¹æ³•</span>        <span class="hljs-keyword">if</span> (methodPropertyModel.<span class="hljs-property">isMethod</span>) &#123;            prototypeOrClsss[methodPropertyModel.<span class="hljs-property">nameString</span>] = <span class="hljs-keyword">function</span> (<span class="hljs-params">...args: unknown[]</span>) &#123;                <span class="hljs-keyword">if</span> (isOfType&lt;<span class="hljs-title class_">HummerBase</span>&gt;(<span class="hljs-variable language_">this</span>, <span class="hljs-string">&#x27;_private&#x27;</span>)) &#123;                    <span class="hljs-comment">// ä¹‹å‰åœ¨ Native ç»™ globalThis æ³¨å†Œçš„ hummerCall åœ¨è¿™æ—¶å€™æ´¾ä¸Šç”¨åœºäº†</span>                    <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerCall</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_private</span>, jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>, ...args)                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-comment">// ç±»æ–¹æ³•è°ƒç”¨</span>                    <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerCall</span>(jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>, ...args)                &#125;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(prototypeOrClsss, methodPropertyModel.<span class="hljs-property">nameString</span>, &#123;                <span class="hljs-comment">// getter setter æ³¨å†Œ</span>                <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: HummerBase | unknown</span>) &#123;                    <span class="hljs-keyword">if</span> (isOfType&lt;<span class="hljs-title class_">HummerBase</span>&gt;(<span class="hljs-variable language_">this</span>, <span class="hljs-string">&#x27;_private&#x27;</span>)) &#123;                        <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerGetProperty</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_private</span>, jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>)                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerGetProperty</span>(jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>)                    &#125;                &#125;,                <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-variable language_">this</span>: HummerBase | unknown, newValue: unknown</span>) &#123;                    <span class="hljs-keyword">if</span> (isOfType&lt;<span class="hljs-title class_">HummerBase</span>&gt;(<span class="hljs-variable language_">this</span>, <span class="hljs-string">&#x27;_private&#x27;</span>)) &#123;                        <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerSetProperty</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_private</span>, jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>, newValue)                    &#125; <span class="hljs-keyword">else</span> &#123;                        <span class="hljs-keyword">return</span> globalThis.<span class="hljs-title function_">hummerSetProperty</span>(jsClassName, methodPropertyModel.<span class="hljs-property">nameString</span>, newValue)                    &#125;                &#125;            &#125;)        &#125;    &#125;)    <span class="hljs-comment">// ç»™ jsClass æ·»åŠ  name å±æ€§ï¼Œå€¼æ˜¯ jsClassNameï¼ˆæ¯”å¦‚ &#x27;Text&#x27;ï¼‰       </span>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(jsClass, <span class="hljs-string">&#x27;name&#x27;</span>, &#123; <span class="hljs-attr">value</span>: jsClassName &#125;)    <span class="hljs-comment">// å°† jsClass æŒ‚è½½åˆ° globalThis ä¸Š</span>    globalThis[jsClassName] = jsClass    <span class="hljs-keyword">return</span> jsClass <span class="hljs-comment">// ä¸è¿”ä¹Ÿè¡Œï¼Œåæ­£ä¹Ÿæ²¡ç”¨</span>&#125;</code></pre></div><h1 id="ç»ˆäºï¼šæ‰§è¡Œ-JS-ä»£ç "><a href="#ç»ˆäºï¼šæ‰§è¡Œ-JS-ä»£ç " class="headerlink" title="ç»ˆäºï¼šæ‰§è¡Œ JS ä»£ç "></a>ç»ˆäºï¼šæ‰§è¡Œ JS ä»£ç </h1><p>ç­‰æ‰§è¡Œäº† builtin.js, å†æ‰§è¡Œ JS å‡½æ•° <strong>hummerLoadClass</strong>ï¼ŒHummer è¿™è½¦å¼•æ“æœ‰äº†ï¼Œæ§åˆ¶å™¨æ–¹å‘ç›˜æ²¹é—¨ä»€ä¹ˆçš„ä¹Ÿé½äº†ï¼Œå¯ä»¥å¼€è½¦ä¸Šè·¯ï¼Œæ‰§è¡Œä¸šåŠ¡å¼€å‘è€…å†™çš„ ts ä»£ç äº†ï¼Œæ¯”å¦‚ï¼š</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">Hummer</span>,<span class="hljs-title class_">View</span>, <span class="hljs-title class_">Text</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@hummer/hummer-front&#x27;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">RootView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">View</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">super</span>();    <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span> = &#123;      <span class="hljs-attr">width</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,      <span class="hljs-attr">height</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,      <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&#x27;flex-start&#x27;</span>,      <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">&#x27;center&#x27;</span>    &#125;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initElement</span>()  &#125;  <span class="hljs-title function_">initElement</span>(<span class="hljs-params"></span>)&#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">appendText</span>(<span class="hljs-string">&#x27;~ Hello Hummer ~&#x27;</span>)  &#125;  <span class="hljs-title function_">appendText</span>(<span class="hljs-params">message:string</span>)&#123;    <span class="hljs-keyword">var</span> text = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>()    text.<span class="hljs-property">style</span> = &#123;      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,    &#125;    text.<span class="hljs-property">text</span> = message    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">appendChild</span>(text);  &#125;&#125;<span class="hljs-comment">// æ ¹é¡µé¢æ¸²æŸ“</span><span class="hljs-title class_">Hummer</span>.<span class="hljs-title function_">render</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RootView</span>());</code></pre></div><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æˆ‘ä»¬æ”¶æ‹¾ä¸€ä¸‹æ€è·¯ï¼Œé—®å‡ºä¸€ä¸ªå¯ä»¥æ¦‚æ‹¬æœ¬ç¯‡æ–‡ç« çš„é—®é¢˜ï¼š</p><p><strong>å¦‚ä½•å®ç°ä¸€ä¸ªè·¨ç«¯æ¡†æ¶ï¼Ÿ</strong></p><p>é¦–å…ˆï¼Œä½ è¦åœ¨ Native ä¾§è¦å®ç°å¾ˆå¤šå¾ˆå¤šä¸ªç±»ï¼Œè¿™æ ·js ä¾§æ‰æœ‰ä¸œè¥¿å¯ä»¥è°ƒç”¨ã€‚ä¸ä»…è¦å®ç°ï¼Œè¿˜å¾—æŠŠè¿™äº›ç±»ä¿¡æ¯è®°å½•ä¸‹æ¥æ”¾åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ js ä¾§é€šè¿‡è¿™ä¸ªå¯¹è±¡èƒ½æ‰¾åˆ°è¿™äº›ç±»ã€‚</p><p>å…¶æ¬¡ï¼Œä½ è¦åˆ›å»º js ä¾§è°ƒç”¨ Nativeçš„å£å­ï¼Œè¦æŠŠæŸäº›å¿…ä¸å¯å°‘çš„ C å‡½æ•°æ³¨å†Œåˆ° js ä¾§ï¼Œæ‰§è¡Œ Hummer å†…ç½®çš„builtin.js ï¼ŒæŠŠ js ç¯å¢ƒå€’è…¾å¥½ã€‚js ä¾§è¦åªèƒ½æœ‰å“ªäº›ç±»ï¼Œå¹¶ä¸”èƒ½è°ƒç”¨è¿™äº›ç±»ï¼Œåˆ›å»º Native å¯¹è±¡ï¼Œè·Ÿ Native å¯¹è±¡äº¤äº’ã€‚</p><p><strong>æ­¤æ—¶ï¼Œè·¨ç«¯æ¡†æ¶å·²ç»å‡†å¤‡å¥½è¿è¡Œä¸šåŠ¡ä»£ç äº†ã€‚</strong></p><hr><h1 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h1><ul><li><p>è·¨ç«¯æ¡†æ¶ Hummer é€šä¿¡æœºåˆ¶ - iOS ç‰ˆï¼ˆæ»´æ»´å†…éƒ¨èµ„æ–™ï¼‰</p></li><li><p><a href="https://www.jianshu.com/p/6fc9974f515a?u_atoken=4e84bfbb-0d2e-4dd6-99bc-bf376df6aa9f&u_asession=01-huAtRfx0hH5UHzwe8Lh1s7DC96dFR0qdNL_EgJm1fu2KgW8m8woPJnOYLo65jzIX0KNBwm7Lovlpxjd_P_q4JsKWYrT3W_NKPr8w6oU7K-99uxyLsFnLLOQ3YDOLFetPIF6hypDqzN_tz02ZDuS7GBkFo3NEHBv0PZUm6pbxQU&u_asig=053oswMXvKuIBz4WVlP8kItSqk3YST1EJuHkD2nP-UJVOYAznuMy2S0H_UNoC1GqgFS_0k5IkAplJG2_ZzculU_tdvMS4FknKIlUSJscxog5mvHbREZZYDHcYd9TT8p6p9mHIow13wRLoBvk1stpyXtRF3Q4RMUR8-fDCOzTWd9dT9JS7q8ZD7Xtz2Ly-b0kmuyAKRFSVJkkdwVUnyHAIJzWa_ZlFcbc1GNzPML23AOVWwB8kYhvUlAIbkfK006hx-HLC90DffcRgc58NhmjbgM-3h9VXwMyh6PgyDIVSG1W-VyZZSvkD2KpzhcSb3FsM0-ugCNFY0FZyNegwerOk566aGIEHC8TOnb34QgAOin7eHYTj2zIIrFgiM-Kc-R44omWspDxyAEEo4kbsryBKb9Q&u_aref=V231vK39fNOpAG/085YUfwQtIvQ=" title="__dataåœ¨ç¼–è¯‘é˜¶æ®µå¤„ç†åè®®">__dataåœ¨ç¼–è¯‘é˜¶æ®µå¤„ç†åè®®</a></p></li><li><p><a href="https://developer.arm.com/documentation/dui0474/g/using-scatter-files/using---attribute----section--name-----to-place-code-and-data" title="Using ">Using </a><a href="https://developer.arm.com/documentation/dui0474/g/using-scatter-files/using---attribute----section--name-----to-place-code-and-data" title="attribute"><strong>attribute</strong></a><a href="https://developer.arm.com/documentation/dui0474/g/using-scatter-files/using---attribute----section--name-----to-place-code-and-data" title="((section(&quot;name&quot;))) to place code and data">((section(â€œnameâ€))) to place code and data</a>ï¼ˆå°±é‚£ä¸ªå®çš„æ–‡æ¡£ï¼‰</p></li><li><p><a href="https://docs.ultralig.ht/docs/calling-a-c-function-from-js" title="Calling a C Function From JS">Calling a C Function From JS</a></p></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>è·¨ç«¯æ¡†æ¶Hummer æ˜¯å¦‚ä½•æ¸²æŸ“çš„ï¼Ÿï¼ˆiOS ç‰ˆ)</title>
    <link href="/2022/07/25/%E8%B7%A8%E7%AB%AF%E6%A1%86%E6%9E%B6Hummer%20%E6%98%AF%E5%A6%82%E4%BD%95%E6%B8%B2%E6%9F%93%E7%9A%84%EF%BC%9F%EF%BC%88iOS%20%E7%89%88%EF%BC%89/"/>
    <url>/2022/07/25/%E8%B7%A8%E7%AB%AF%E6%A1%86%E6%9E%B6Hummer%20%E6%98%AF%E5%A6%82%E4%BD%95%E6%B8%B2%E6%9F%93%E7%9A%84%EF%BC%9F%EF%BC%88iOS%20%E7%89%88%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p><a href="https://hummer.didi.cn/doc#/zh-CN/" title="Hummer"><strong>Hummer</strong></a>æ˜¯ç›®å‰æ»´æ»´è´§è¿å¸æœºç«¯æ­£åœ¨ä½¿ç”¨çš„è·¨ç«¯æ¡†æ¶ï¼Œä¹‹å‰åœ¨å¼€å‘éœ€æ±‚çš„æ—¶å€™ç¢°åˆ°äº†è¯¡å¼‚çš„å¸ƒå±€é—®é¢˜ï¼Œç”±äºè‡ªå·±æ˜¯åˆšæ¥è§¦ï¼Œå®Œå…¨ä¸çŸ¥é“ä»å“ªé‡Œä¸‹æ‰‹æ’æŸ¥é—®é¢˜ï¼Œäºæ˜¯è¯·æ¥äº†å…„å¼Ÿéƒ¨é—¨ Hummer iOS ç°åœ¨çš„ç»´æŠ¤è€…å²å¹¿è¿œï¼Œçœ‹ç€ä»–ä¸€æ­¥ä¸€æ­¥åœ°æ‰“æ–­ç‚¹ï¼Œæ‰“æ—¥å¿—ï¼Œæœ€ç»ˆæˆåŠŸå®šä½é—®é¢˜ï¼Œç»™å‡ºäº†è§£å†³æ–¹æ¡ˆã€‚å¿ƒé‡Œæ•¬ä½©å¾—å¾ˆã€‚</p><p>æ‰€ä»¥æ—¢ä¸ºäº†ä»¥åå¼€å‘èƒ½å¤Ÿæœ‰ç‹¬ç«‹æ’æŸ¥é—®é¢˜çš„èƒ½åŠ›ï¼Œä¹Ÿä¸ºäº†æé«˜è‡ªå·±å¯¹äºè·¨ç«¯æŠ€æœ¯çš„ç†è§£ï¼Œè¿™å°±æ¥æ•´ç†äº†ä¸‹Hummer çš„æ¸²æŸ“æœºåˆ¶ï¼š</p><p><img src="/../image/hummerRender/hummer.png"></p><hr><p>ä»æˆ‘ä»¬çš„é¢˜ç›®å¼€å§‹ï¼š<strong>Hummeråœ¨ iOS ä¾§æ˜¯å¦‚ä½•æ¸²æŸ“çš„ï¼Ÿ</strong></p><p>å¦‚åŒæŠŠå¤§è±¡å¡è¿›å†°ç®±ï¼Œæˆ‘åˆ†ä¸º 5 æ­¥ï¼š</p><ol><li>åˆ›å»ºï¼šæŠŠç»„ä»¶å®ä¾‹åŒ–ï¼Œåˆ›å»ºå‡ºæ¥</li><li>è®¾ç½®ï¼šè®¾ç½®å®ƒçš„ style å’Œå±æ€§</li><li>æ¸²æŸ“ï¼šæŠŠå‡†å¤‡å¥½çš„ç»„ä»¶æ·»åŠ åˆ° yoga èŠ‚ç‚¹æ ‘ä¸Šï¼Œä¹Ÿæ˜¯æ·»åŠ åˆ°å±å¹•ä¸Š</li><li>æ ‡è®°ï¼šæ ‡è®°éœ€è¦é‡æ–°è®¡ç®—ã€åˆ·æ–°çš„ç»„ä»¶</li><li>å¸ƒå±€ï¼šè°ƒç”¨ yoga å¯¹ç»„ä»¶è¿›è¡Œå¸ƒå±€</li></ol><hr><blockquote><p>Hummer æ—¢å¯ä»¥ç”¨ TypeScript å†™ï¼Œä¹Ÿå¯ä»¥ç”¨Tenon å†™ï¼Œæœ¬æ–‡é‡‡ç”¨ç¬¬ä¸€ç§å†™æ³•ã€‚</p></blockquote><p>é¦–å…ˆæ¥çœ‹ç”¨<strong>TypeScript</strong> å†™çš„ä¸šåŠ¡ä»£ç ï¼š</p><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">Hummer</span>,<span class="hljs-title class_">View</span>, <span class="hljs-title class_">Text</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@hummer/hummer-front&#x27;</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">RootView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">View</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">super</span>();    <span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span> = &#123;      <span class="hljs-attr">width</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,      <span class="hljs-attr">height</span>: <span class="hljs-string">&#x27;100%&#x27;</span>,      <span class="hljs-attr">alignItems</span>: <span class="hljs-string">&#x27;flex-start&#x27;</span>,      <span class="hljs-attr">justifyContent</span>: <span class="hljs-string">&#x27;center&#x27;</span>    &#125;    <span class="hljs-comment">// åˆ›å»ºäº†ä¸€ä¸ª Text ç»„ä»¶</span>    <span class="hljs-keyword">var</span> text = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Text</span>()    text.<span class="hljs-property">style</span> = &#123;      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>    &#125;    text.<span class="hljs-property">text</span> = <span class="hljs-string">&#x27;~ Hello Hummer ~&#x27;</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">appendChild</span>(text);  &#125;&#125;<span class="hljs-comment">// æ ¹é¡µé¢æ¸²æŸ“</span><span class="hljs-title class_">Hummer</span>.<span class="hljs-title function_">render</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RootView</span>());</code></pre></div><p>ç®€å•ï¼Œå¤©çœŸï¼Œå‡ ä¹åªå†™äº†ä¸€ä¸ª <strong>Text</strong> ç»„ä»¶ã€‚</p><h3 id="1-å®ä¾‹åŒ–ï¼šã€Œç‰¹åˆ«é¸£è°¢ä½ åˆ¶é€ æ›´æ¬¢ä¹çš„æˆ‘ã€"><a href="#1-å®ä¾‹åŒ–ï¼šã€Œç‰¹åˆ«é¸£è°¢ä½ åˆ¶é€ æ›´æ¬¢ä¹çš„æˆ‘ã€" class="headerlink" title="1 å®ä¾‹åŒ–ï¼šã€Œç‰¹åˆ«é¸£è°¢ä½ åˆ¶é€ æ›´æ¬¢ä¹çš„æˆ‘ã€"></a>1 å®ä¾‹åŒ–ï¼šã€Œç‰¹åˆ«é¸£è°¢ä½ åˆ¶é€ æ›´æ¬¢ä¹çš„æˆ‘ã€</h3><p>åœ¨æ‰§è¡Œ var text &#x3D; new Text() æ—¶ï¼Œåœ¨ Native ä¾§å°±å¾—<strong>åˆ›å»ºä¸€ä¸ª HMLabelå®ä¾‹ï¼Œå¹¶ä¸”è¦æŠŠå®ä¾‹è£…å…¥ä¸€ä¸ª JS å¯¹è±¡ä¸­è¿”å›ç»™ JS</strong>ï¼Œå®ƒè¿˜å¾—æŒæœ‰ä¸€ä¸‹ã€‚è¿™ä¸€æ­¥äº¤ç»™è°æ¥åš â€”â€”<strong>hummerCreate</strong>: å‡½æ•°ã€‚</p><blockquote><p>1 è°ƒç”¨ HumemrBase çš„ constructor æ–¹æ³•<br>2 æ ¹æ® name å±æ€§è·å– className &amp; check cache<br>3è°ƒç”¨ globalThis çš„ hummerCreate æ–¹æ³•ç”Ÿæˆ native å¯¹åº”çš„è§†å›¾å®ä¾‹ &amp; è¢« this._ptivate æŒæœ‰<br>â€”â€”ã€Šè·¨ç«¯æ¡†æ¶ Hummer é€šä¿¡æœºåˆ¶ - iOS ç‰ˆã€‹</p></blockquote><div class="code-wrapper"><pre><code class="hljs objective-c">JSValueRef _Nullable hummerCreate(JSContextRef ctx, JSObjectRef function, JSObjectRef thisObject, size_t argumentCount, const JSValueRef _Nonnull arguments[], JSValueRef *exception) &#123;    HMAssertMainQueue();     if (argumentCount &lt; 2) &#123;        HMLogError(HUMMER_CREATE_ERROR);        return NULL;    &#125;    HMJSCExecutor *executor = (HMJSCExecutor *) [HMExecutorMap objectForKey:[NSValue valueWithPointer:JSContextGetGlobalContext(ctx)]];    NSString *className = [executor convertValueRefToString:arguments[0] isForce:NO];    if (className.length == 0) &#123;        HMLogError(HUMMER_CREATE_ERROR);        return NULL;    &#125;    // è·å–å¯¼å‡ºç±»    HMExportClass *exportClass = HMExportManager.sharedInstance.jsClasses[className];    NSString *objcClassName = exportClass.className;    if (objcClassName.length == 0) &#123;        HMLogError(HUMMER_CREATE_CLASS_NOT_FOUND, className);        return NULL;    &#125;    // className æ˜¯ Hummer ä¾§çš„ç±»åï¼ˆæ¯”å¦‚ Textï¼‰    // objcClassName æ˜¯ Native ä¾§çš„ç±»åï¼ˆæ¯”å¦‚ HMLabelï¼‰    Class clazz = NSClassFromString(objcClassName);    if (!clazz) &#123;        HMLogError(HUMMER_CREATE_CLASS_NOT_FOUND, className);        return NULL;    &#125;    // jscallå›è°ƒ    HMJSContext *context = [[HMJSGlobal globalObject] currentContext:executor];        // åˆ›å»ºä¸é€æ˜æŒ‡é’ˆ    NSObject *opaquePointer = NULL;    NSMutableArray&lt;HMBaseValue *&gt; *argumentArray = nil;    for (int i = 2; i &lt; argumentCount; ++i) &#123;        HMBaseValue *value = [[HMJSCStrongValue alloc] initWithValueRef:arguments[i] executor:executor];        if (!argumentArray) &#123;            argumentArray = [NSMutableArray arrayWithCapacity:argumentCount - 2];        &#125;        if (value) &#123;            [argumentArray addObject:value];        &#125;    &#125;#ifdef HMDEBUG    [HMJSCallerInterceptor callNativeWithClassName:className functionName:@&quot;constructor&quot; objectRef:nil args:argumentArray context:context];#endif    HMCurrentExecutor = executor;    // æ”¯æŒ HMJSObjectï¼Œå¦‚æœä¸æ”¯æŒåˆ™å›é€€ init    // ä¸åˆ¤æ–­ argumentCount &gt; 2ï¼Œå› ä¸º UIView å¿…é¡»è°ƒç”¨ HMJSObject åˆå§‹åŒ–æ–¹æ³•    if ([clazz conformsToProtocol:@protocol(HMJSObject)]) &#123;        opaquePointer = (id) [(id) [clazz alloc] initWithHMValues:argumentArray];    &#125; else &#123;        HMOtherArguments = argumentArray.copy;        opaquePointer = [[clazz alloc] init];    &#125;    HMCurrentExecutor = nil;    HMOtherArguments = nil;    if (!opaquePointer) &#123;        HMLogError(HUMMER_CAN_NOT_CREATE_NATIVE_OBJECT, className);        return NULL;    &#125;    // å…³è” hm_value    opaquePointer.hmValue = [[HMJSCStrongValue alloc] initWithValueRef:arguments[1] executor:executor];    // å¼•ç”¨è®¡æ•° +1    HMLogDebug(HUMMER_CREATE_TEMPLATE, className);    JSClassDefinition hostObjectClassDef = kJSClassDefinitionEmpty;    hostObjectClassDef.version = 0;    hostObjectClassDef.attributes = kJSClassAttributeNoAutomaticPrototype;    hostObjectClassDef.finalize = hummerFinalize;    JSClassRef hostObjectClass = JSClassCreate(&amp;hostObjectClassDef);    // å¡«å……ä¸é€æ˜æŒ‡é’ˆ    JSObjectRef objectRef = JSObjectMake(ctx, hostObjectClass, (__bridge void *) opaquePointer);    if (objectRef) &#123;        CFRetain((__bridge CFTypeRef) opaquePointer);    &#125;    JSClassRelease(hostObjectClass);    return objectRef;&#125;</code></pre></div><p>è¿™ä¸ªå‡½æ•°åšäº†ï¼š</p><ol><li>æ ¹æ® Hummer ä¾§ä¼ è¿‡æ¥çš„æ¶ˆæ¯è·å–åˆ°äº†åœ¨ Native ä¾§æ³¨å†Œçš„ç±»</li><li>åˆ›å»ºè¿™ä¸ªç±»</li><li>åˆ›å»ºä¸é€æ˜æŒ‡é’ˆï¼ŒæŠŠè¿™ä¸ªç±»å¡«åˆ°ä¸é€æ˜æŒ‡é’ˆå½“ä¸­</li><li>è¿”å›ä¸é€æ˜æŒ‡é’ˆ</li></ol><p><strong>å†æ¬¡å¼ºè°ƒ</strong>ï¼šæœ€ç»ˆè¿”å›çš„æ˜¯<strong>JSObjectRef</strong> å¯¹è±¡ï¼Œä¸æ˜¯ç®€å•çš„ <strong>HMLabel</strong> å¯¹è±¡ã€‚</p><p>æˆ‘çŒœæµ‹è¿™æ ·åšçš„åŸå› æ˜¯ Nativeéœ€è¦è·Ÿ JavaScriptCore è¿›è¡Œé€šä¿¡ï¼Œåªåˆ›å»ºä¸€ä¸ª HMLabel ä½ æ€ä¹ˆè·Ÿ Hummer ä¾§è¿›è¡Œäº¤æµï¼Œåç»­ Hummer æ€ä¹ˆæ‹¿åˆ°è¿™ä¸ªå¯¹è±¡è¿›è¡Œè®¾ç½®ï¼Ÿ</p><h3 id="2-1è®¾ç½®-styleï¼š"><a href="#2-1è®¾ç½®-styleï¼š" class="headerlink" title="2.1è®¾ç½® styleï¼š"></a>2.1è®¾ç½® styleï¼š</h3><p>HMLabel åˆ›å»ºå‡ºæ¥åï¼Œå°±éœ€è¦è®¾ç½®å®ƒçš„æ ·å¼ï¼Œæ¯”å¦‚ heightã€widthç­‰ã€‚Hummer ä¾§ä¼šä¸€ä¸ªå‘ setStyle çš„ä¿¡å·ï¼ŒNativeä¼šè°ƒç”¨hm_setStyle: æ–¹æ³•</p><blockquote><p>è¿™å±‚è½¬åŒ–æ˜¯é€šè¿‡ HM_EXPORT_PROPERTY è¿™ä¸ªå®å®ç°çš„</p></blockquote><div class="code-wrapper"><pre><code class="hljs objective-c">- (void)hm_setStyle:(HMBaseValue *)style &#123;    // è½¬åŒ–äº¤ç»™ HMJSCExecutor å®Œæˆ    id styleObject = style.toDictionary;    NSDictionary *styleDic = nil;    if ([styleObject isKindOfClass:NSDictionary.class]) &#123;        styleDic = styleObject;    &#125;    if (styleDic.count == 0) &#123;        HMLogError(@&quot;style å¿…é¡»æœ‰é”®å€¼å¯¹&quot;);        return;    &#125;    // æŠŠ style ä¿¡æ¯åˆ’åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼šå¸ƒå±€ã€å±æ€§ï¼ˆæ ·å¼ï¼‰ã€è¿‡æ¸¡ä¿¡æ¯ï¼ˆåŠ¨ç”»ç›¸å…³ï¼‰    NSMutableDictionary&lt;NSString *, NSObject *&gt; *layoutInfo = NSMutableDictionary.dictionary;    NSMutableDictionary&lt;NSString *, NSObject *&gt; *attributes = NSMutableDictionary.dictionary;    NSMutableDictionary&lt;NSString *, NSObject *&gt; *transitions = NSMutableDictionary.dictionary;    [styleDic enumerateKeysAndObjectsUsingBlock:^(id key, id obj, BOOL *stop) &#123;        if (![key isKindOfClass:NSString.class]) &#123;            return;        &#125;                // æ¯”å¦‚ leftï¼ŒflexDirection        if ([[self hm_layoutInfoKeys] containsObject:key]) &#123;            layoutInfo[key] = obj;        &#125; else if ([[self hm_transtionInfoKeys] containsObject:key]) &#123;        // æ¯”å¦‚ transitionDelayï¼Œ            transitions[key] = obj;        &#125; else &#123;        // æ¯”å¦‚ backgroundColor            attributes[key] = obj;        &#125;        // å¸ƒå±€ã€å±æ€§å’Œè¿‡æ¸¡ä¿¡æ¯å¯ä»¥çœ‹æ–‡æ¡£ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆ        // https://hummer.didi.cn/doc#/zh-CN/normal_view_style    &#125;];    NSMutableDictionary&lt;NSString *, NSObject *&gt; *mutableStyleDictionary = self.hm_styleStore.mutableCopy;    if (!mutableStyleDictionary) &#123;        mutableStyleDictionary = [NSMutableDictionary dictionaryWithCapacity:layoutInfo.count + attributes.count + transitions.count];    &#125;    // æŠŠåˆ†å¥½çš„ä¸‰éƒ¨åˆ†åˆè£…äº†å›å»ï¼Œè®© self.hm_styleStore æŒæœ‰    self.hm_styleStore = nil;    [mutableStyleDictionary addEntriesFromDictionary:layoutInfo];    [mutableStyleDictionary addEntriesFromDictionary:attributes];    [mutableStyleDictionary addEntriesFromDictionary:transitions];    self.hm_styleStore = mutableStyleDictionary;    ...    [attributes enumerateKeysAndObjectsUsingBlock:^(NSString *key, NSObject *obj, BOOL *stop) &#123;        // è¿‡æ»¤éœ€è¦åŠ¨ç”»çš„å±æ€§ï¼Œé€šè¿‡åŠ¨ç”»å±•ç¤º        if (self.hm_transitionAnimation &amp;&amp; [self.hm_transitionAnimation.needAnimations.allKeys containsObject:key]) &#123;            [transitionAnimations addEntriesFromDictionary:@&#123;key: obj&#125;];        &#125; else &#123;            // layoutInfoã€attributes å°±é€šè¿‡è¿™ä¸ªè®¾ç½®            [self hm_configureWithTarget:self cssAttribute:key value:obj converterManager:HMAttrManager.sharedManager];        &#125;    &#125;];        ...    // æ ‡è®°ï¼šè¯¥ç»“ç‚¹éœ€è¦é‡æ–°è®¡ç®—ä½ç½®    [self hm_markDirty];&#125;</code></pre></div><p>ç”¨æˆ‘æ˜“ï¼ˆç²—ï¼‰æ‡‚ï¼ˆæš´ï¼‰çš„è¯­è¨€è¯´å°±æ˜¯ï¼š</p><ol><li>HMJSCExecutor æŠŠ Hummer ä¾§çš„ style å­—å…¸è½¬æˆNSDictionary</li><li>æŠŠNSDictionaryé‡Œçš„å…ƒç´ åˆ’åˆ†æˆä¸‰ç§ä¸åŒçš„ styleï¼šå¸ƒå±€ã€å±æ€§ã€è¿‡æ¸¡ç›¸å…³çš„</li><li>è®¾ç½®ç»™hm_styleStoreæŒæœ‰</li><li>é€šè¿‡hm_configureWithTarget: cssAttribute: value:converterManager: å‡½æ•°å®é™…å»è®¾ç½®å¯¹åº”çš„ style å€¼</li></ol><h3 id="2-2-è®¾ç½®-Property-ï¼ˆæ¯”å¦‚-Text-çš„-text-å±æ€§ï¼‰"><a href="#2-2-è®¾ç½®-Property-ï¼ˆæ¯”å¦‚-Text-çš„-text-å±æ€§ï¼‰" class="headerlink" title="2.2 è®¾ç½® Property ï¼ˆæ¯”å¦‚ Text çš„ text å±æ€§ï¼‰"></a>2.2 è®¾ç½® Property ï¼ˆæ¯”å¦‚ Text çš„ text å±æ€§ï¼‰</h3><div class="code-wrapper"><pre><code class="hljs objective-c">// ä¸ç®¡æ˜¯ get è¿˜æ˜¯ set éƒ½æ˜¯è°ƒç”¨è¿™ä¸ªæ–¹æ³•- (JSValueRef)hummerGetSetPropertyWithArgumentCount:(size_t)argumentCount arguments:(const JSValueRef _Nonnull[])arguments isSetter:(BOOL)isSetter &#123;    ...    // è¿™é‡Œä¸ºä»€ä¹ˆè¦æŠŠ argument[0] è½¬æˆ JSObjectRefï¼Ÿ    JSObjectRef objectRef = NULL;    if (JSValueIsObject(self.contextRef, arguments[0])) &#123;        JSValueRef exception = NULL;        objectRef = JSValueToObject(self.contextRef, arguments[0], &amp;exception);        [self popExceptionWithErrorObject:&amp;exception];    &#125;    ...    // è·å–å¯¹åº”çš„ç±»å    NSString *className = [self convertValueRefToString:arguments[objectRef ? 1 : 0] isForce:NO];    if (className.length == 0) &#123;        return NULL;    &#125;    NSString *propertyName = [self convertValueRefToString:arguments[objectRef ? 2 : 1] isForce:NO];    if (propertyName.length == 0) &#123;        return NULL;    &#125;    id target = nil;    SEL selector = nil;    NSMethodSignature *methodSignature = nil;    [self hummerExtractExportWithFunctionPropertyName:propertyName objectRef:objectRef target:&amp;target selector:&amp;selector methodSignature:&amp;methodSignature isSetter:isSetter jsClassName:className];    // é€šè¿‡å¯¼å‡ºç±»ã€å¯¼å‡ºæ–¹æ³•ï¼Œè·å–åˆ°äº† Native ç±»ã€å¯¹åº”çš„æ–¹æ³•    ...    // è½¬å‘æ¶ˆæ¯ï¼Œè°ƒç”¨åŸç”Ÿæ–¹æ³•    return [self hummerCallNativeWithArgumentCount:argumentCount arguments:arguments target:target selector:selector methodSignature:methodSignature];&#125;- (JSValueRef)hummerCallNativeWithArgumentCount:(size_t)argumentCount arguments:(JSValueRef const[])arguments target:(id)target selector:(SEL)selector methodSignature:(NSMethodSignature *)methodSignature &#123;    ...    BOOL isClass = object_isClass(target);    NSMutableArray&lt;HMBaseValue *&gt; *otherArguments = nil;    HMCurrentExecutor = self;    // éšå«ç€ numerOfArguments + 0/1 &lt;= argumentCount    for (NSUInteger i = methodSignature.numberOfArguments + (isClass ? 0 : 1); i &lt; argumentCount; ++i) &#123;        // å¤šä½™çš„è½¬æ•°ç»„        HMBaseValue *hummerValue = [[HMJSCStrongValue alloc] initWithValueRef:arguments[i] executor:HMCurrentExecutor];        if (!otherArguments) &#123;            otherArguments = [NSMutableArray arrayWithCapacity:argumentCount - methodSignature.numberOfArguments];        &#125;        if (hummerValue) &#123;            [otherArguments addObject:hummerValue];        &#125;    &#125;    // å­˜å‚¨é¢å¤–å‚æ•°    HMOtherArguments = otherArguments.copy;    NSInvocation *invocation = [NSInvocation invocationWithMethodSignature:methodSignature];    invocation.target = target;    invocation.selector = selector;    // åç»­åšå¾ªç¯ï¼Œéƒ½æ˜¯ä¸´æ—¶å˜é‡ï¼Œå¦‚æœä¸åš retainï¼Œä¼šå¯¼è‡´é‡æŒ‡é’ˆ    [invocation retainArguments];    // å‚æ•°    // æœ¬è´¨ä¸º MIN(methodSignature.numberOfArguments, argumentCount - (isClass : 0 : 1))ï¼Œä¸»è¦ä¸ºäº†é˜²æ­¢æ— ç¬¦å·æ•°å­—æº¢å‡º    for (NSUInteger i = 2; i &lt; MIN(methodSignature.numberOfArguments + (isClass ? 0 : 1), argumentCount) - (isClass ? 0 : 1); ++i) &#123;        const char *objCType = [methodSignature getArgumentTypeAtIndex:i];        HMEncodingType type = HMEncodingGetType(objCType);        id param = nil;        if (type == HMEncodingTypeBlock) &#123;            // Block            param = [(HMJSCExecutor *) HMCurrentExecutor convertValueRefToFunction:arguments[i + (isClass ? 0 : 1)]];        &#125; else if (type == HMEncodingTypeObject) &#123;            // HMJSCValue            param = [[HMJSCStrongValue alloc] initWithValueRef:arguments[i + (isClass ? 0 : 1)] executor:HMCurrentExecutor];        &#125; else if (HMEncodingTypeIsCNumber(type)) &#123;            // js åªå­˜åœ¨ double å’Œ bool ç±»å‹ï¼Œä½†åŸç”Ÿéœ€è¦åŒºåˆ†å…·ä½“ç±»å‹ã€‚            param = [(HMJSCExecutor *) HMCurrentExecutor convertValueRefToNumber:arguments[i + (isClass ? 0 : 1)] isForce:NO];        &#125; else &#123;            HMLogError(HUMMER_UN_SUPPORT_TYPE_TEMPLATE, objCType);        &#125;        [invocation hm_setArgument:param atIndex:i encodingType:type];    &#125;    // æ‹¼è£…å®Œæ¯•ï¼Œæ‰§è¡Œæ–¹æ³•    [invocation invoke];    HMOtherArguments = nil;    // è¿”å›å€¼    JSValueRef returnValueRef = NULL;    const char *objCReturnType = methodSignature.methodReturnType;    HMEncodingType returnType = HMEncodingGetType(objCReturnType);    if (returnType != HMEncodingTypeVoid &amp;&amp; returnType != HMEncodingTypeUnknown) &#123;        id returnObject = [invocation hm_getReturnValueObject];        if (returnObject) &#123;            returnValueRef = [(HMJSCExecutor *) HMCurrentExecutor convertObjectToValueRef:returnObject];        &#125;    &#125;    HMCurrentExecutor = nil;    return returnValueRef;&#125;</code></pre></div><p>ç»§ç»­ç²—æš´æè¿°ï¼š</p><ol><li>è·å–åˆ° Native ä¾§å·²ç»æ³¨å†Œçš„ç±»åï¼Œè·å–åˆ° getter å’Œ setter</li><li>æ‹¼è£…NSInvocationï¼Œå¤„ç†å‚æ•°ï¼Œç„¶åè°ƒç”¨ invoke æ–¹æ³•æ‰§è¡ŒNative çš„ getter å’Œ setter</li><li>æ‰§è¡Œå®Œæˆåï¼Œè·å–è¿”å›å€¼</li><li>æœ€åæŠŠJSValueRefè¿”å›ç»™JSC(æˆ‘ç†è§£å°±æ˜¯ Hummer ä¾§)</li></ol><h3 id="3-renderæ¸²æŸ“"><a href="#3-renderæ¸²æŸ“" class="headerlink" title="3 renderæ¸²æŸ“"></a>3 renderæ¸²æŸ“</h3><p>è¯¥åˆ›å»ºçš„åˆ›äº†ï¼Œè¯¥è®¾ç½®çš„è®¾äº†ï¼Œç„¶åå¾—æŠŠå®ƒä»¬æ¸²æŸ“åˆ°å±å¹•ä¸Š</p><div class="code-wrapper"><pre><code class="hljs objective-c">- (void)render:(HMBaseValue *)page &#123;    id&lt;HMBaseExecutorProtocol&gt; executor = page.context;    HMJSContext *context = [HMJSGlobal.globalObject currentContext:executor ? executor : HMCurrentExecutor];    context.didCallRender = YES;    // é‡Œé¢è¿˜æ˜¯ç”¨ HMJSCExecutor å°† HMBaseValue è½¬æˆå…·ä½“çš„ç±»ï¼Œæ¯”å¦‚ UIView    NSObject *viewObject = page.toNativeObject;    if (!viewObject || ![viewObject isKindOfClass:UIView.class]) &#123;        return;    &#125;    UIView *view = (UIView *) viewObject;    [context didRenderPage:page nativeView:view];&#125;- (void)didRenderPage:(HMBaseValue *)page nativeView:(nonnull UIView *)view&#123;        self.componentView = page;    // æŠŠè¿™ä¸ª View æ·»åŠ åˆ°å±å¹•ä¸Š(ä¼šè°ƒç”¨ Yoga æŠŠèŠ‚ç‚¹æ’å…¥åˆ°èŠ‚ç‚¹æ ‘ä¸Š)    [self.rootView addSubview:view];    self.rootView.isHmLayoutEnabled = YES;    [self.rootView hm_markDirty];    if ([self.delegate respondsToSelector:@selector(context:didRenderPage:)]) &#123;        [self.delegate context:self didRenderPage:page];    &#125;    if (self.renderCompletion) &#123;        self.renderCompletion();    &#125;    // æ’åºå½“å‰è§†å›¾    [UIView hm_reSortFixedView:self];    ...&#125;</code></pre></div><p>å¤æ‚åœ°æ¦‚æ‹¬ä¸‹ï¼š</p><ol><li>å°† page è½¬æˆ Native çš„ UIView å¯¹è±¡</li><li>æ¸²æŸ“ UIView</li><li>æŠŠè¿™ä¸ª UIView æ·»åŠ åˆ° rootView ä¸Šï¼Œæ’å…¥åˆ° YogaèŠ‚ç‚¹æ ‘</li></ol><h3 id="4-markDirtyï¼š"><a href="#4-markDirtyï¼š" class="headerlink" title="4 markDirtyï¼š"></a>4 markDirtyï¼š</h3><div class="code-wrapper"><pre><code class="hljs objective-c">- (void)hm_markDirty &#123;    if (!self.isHmLayoutEnabled) &#123;        return;    &#125;    // 1. å¶èŠ‚ç‚¹ -&gt; å¶èŠ‚ç‚¹ï¼ˆè„ï¼‰ï¼Œéœ€è¦ markDirty + setNeedsLayout    // 2. å®¹å™¨èŠ‚ç‚¹ -&gt; å®¹å™¨èŠ‚ç‚¹ï¼ˆè„ï¼‰ï¼Œåªéœ€è¦ setNeedsLayout    // 3. å¶èŠ‚ç‚¹ -&gt; å®¹å™¨èŠ‚ç‚¹ï¼ˆè„ï¼‰ï¼Œåªéœ€è¦ setNeedsLayout    // 4. å®¹å™¨èŠ‚ç‚¹ -&gt; å¶èŠ‚ç‚¹ï¼ˆè„ï¼‰ï¼Œåªéœ€è¦ setNeedsLayout    // YGAttachNodesFromViewHierachy ä¼šé’ˆå¯¹ 2 3 4 æƒ…å†µè‡ªè¡Œåšå‡ºæ ‡è®°è„èŠ‚ç‚¹çš„åŠ¨ä½œ    if (self.hm_renderObject.numberOfChildren == 0 &amp;&amp; self.hm_renderObject.isLeaf) &#123;        // åŸå…ˆæ˜¯å¶èŠ‚ç‚¹ï¼Œç°åœ¨ä¹Ÿæ˜¯å¶èŠ‚ç‚¹        [self.hm_renderObject markDirty];    &#125;    NSAssert(NSThread.isMainThread, @&quot;å¿…é¡»æ˜¯ä¸»çº¿ç¨‹&quot;);    if (!viewSet) &#123;        viewSet = NSHashTable.weakObjectsHashTable;        dispatch_async(dispatch_get_main_queue(), ^&#123;            // å¸ƒå±€å¯¹åº”çš„ Viewï¼ˆæœ€ç»ˆæ˜¯é€šè¿‡ frame çš„æ–¹å¼è¿›è¡Œå¸ƒå±€çš„ï¼‰            [UIView hm_layoutIfNeeded];        &#125;);    &#125;    [viewSet addObject:self];&#125;</code></pre></div><h3 id="5-layout-å¸ƒå±€"><a href="#5-layout-å¸ƒå±€" class="headerlink" title="5 layout å¸ƒå±€"></a>5 layout å¸ƒå±€</h3><div class="code-wrapper"><pre><code class="hljs objective-c">+ (void)hm_layoutIfNeeded &#123;    if (viewSet.count == 0) &#123;        return;    &#125;    NSHashTable&lt;__kindof UIView *&gt; *rootViewSet = nil;    // viewSet æ˜¯é™æ€å˜é‡ï¼Œæˆ‘çŒœæµ‹    NSEnumerator&lt;__kindof UIView *&gt; *enumerator = viewSet.objectEnumerator;    UIView *value = nil;    // æ‰¾åˆ° yoga èŠ‚ç‚¹æ ‘çš„ rootView    while ((value = enumerator.nextObject)) &#123;        UIView *rootView = hm_yoga_get_root_view(value);        if (!rootViewSet) &#123;            rootViewSet = NSHashTable.weakObjectsHashTable;        &#125;        [rootViewSet addObject:rootView];    &#125;    viewSet = nil;    enumerator = rootViewSet.objectEnumerator;    // è°ƒç”¨ yoga è¿›è¡Œå¸ƒå±€    while ((value = enumerator.nextObject)) &#123;        [value hm_layoutYogaRootView];    &#125;&#125;// æœ€ç»ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼š// preserveOriginpreserveOrigin ä¸º YESï¼Œè¡¨ç¤ºå¸ƒå±€çš„æ—¶å€™ç»§æ‰¿ä¸Šä¸€æ¬¡çš„ frame- (void)applyLayoutPreservingOrigin:(BOOL)preserveOriginpreserveOrigin dimensionFlexibility:(HummerDimensionFlexibility)dimensionFlexibility view:(UIView *)view affectedShadowViews:(NSHashTable&lt;HMRenderObject *&gt; *)affectedShadowViews &#123;    // æŠŠ View æ’å…¥åˆ° yoga èŠ‚ç‚¹æ ‘ä¸­    [self attachRenderObjectFromViewHierarchyForRootView:view];    if (!affectedShadowViews) &#123;        affectedShadowViews = [NSHashTable weakObjectsHashTable];    &#125;    HMRenderObject *renderObject = (HMRenderObject *) view.hm_renderObject;    HMRootRenderObject *rootRenderObject = [[HMRootRenderObject alloc] init];    rootRenderObject.renderObject = renderObject;        // æœ€å°å¤§å°ç›´æ¥å¿½ç•¥    CGSize oldMinimumSize = CGSizeMake(HMCoreGraphicsFloatFromYogaValue(YOGA_TYPE_WRAPPER(YGNodeStyleGetMinWidth)(renderObject.yogaNode), 0), HMCoreGraphicsFloatFromYogaValue(YOGA_TYPE_WRAPPER(YGNodeStyleGetMinHeight)(renderObject.yogaNode), 0));    if (!CGSizeEqualToSize(oldMinimumSize, rootRenderObject.minimumSize)) &#123;        rootRenderObject.minimumSize = oldMinimumSize;    &#125;    // é»˜è®¤ç›´æ¥ä½¿ç”¨ rootView å¤§å°    rootRenderObject.availableSize = view.bounds.size;    if (dimensionFlexibility &amp; HummerDimensionFlexibilityWidth) &#123;        CGSize availableSize = rootRenderObject.availableSize;        availableSize.width = CGFLOAT_MAX;        rootRenderObject.availableSize = availableSize;    &#125;    if (dimensionFlexibility &amp; HummerDimensionFlexibilityWidth) &#123;        CGSize availableSize = rootRenderObject.availableSize;        availableSize.height = CGFLOAT_MAX;        rootRenderObject.availableSize = availableSize;    &#125;    // è°ƒç”¨ yoga è¿›è¡Œå¸ƒå±€    [rootRenderObject layoutWithAffectedShadowViews:affectedShadowViews];    if (affectedShadowViews.count &lt;= 0) &#123;        // no frame change results in no UI update block        return;    &#125;    for (HMRenderObject *shadowView in affectedShadowViews) &#123;        HMLayoutMetrics layoutMetrics = shadowView.layoutMetrics;        UIView *inlineView = shadowView.view;        hm_safe_main_thread(^&#123;            inlineView.hm_animationPropertyBounds = inlineView.bounds;            inlineView.hm_animationPropertyCenter = inlineView.center;            CGRect frame = layoutMetrics.frame;            // åªæœ‰åœ¨ HMDisplayTypeNone æˆ– visibility: hidden æƒ…å†µä¸‹ï¼Œéšè—è§†å›¾            BOOL isHidden = layoutMetrics.displayType == HMDisplayTypeNone || inlineView.hm_visibility == YES;            if (inlineView.isHidden != isHidden) &#123;                inlineView.hidden = isHidden;            &#125;            if (view == inlineView) &#123;                // éœ€è¦ç»§æ‰¿ä¸Šæ¬¡çš„ origin                if (preserveOrigin) &#123;                    frame = (CGRect) &#123;                            .origin = &#123;                                    .x = (CGRectGetMinX(frame) + inlineView.frame.origin.x),                                    .y = (CGRectGetMinY(frame) + inlineView.frame.origin.y),                            &#125;,                            .size = frame.size                    &#125;;                &#125;            &#125;            // ä¸º shadowView è®¾ç½® frame            [inlineView hummerSetFrame:frame];        &#125;);    &#125;&#125;</code></pre></div><blockquote><p>shadowView æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”è¾…åŠ©ç±»ï¼Œè´Ÿè´£åœ¨ shadow çº¿ç¨‹è¿›è¡Œå¸ƒå±€ç›¸å…³çš„è®¡ç®—</p></blockquote><p>è‡³æ­¤ï¼Œæˆ‘ä»¬çš„ Text ç»„ä»¶å°±æ·»åŠ åˆ°äº†å±å¹•ä¸Šï¼Œå¹¶æœ€ç»ˆæ˜¾ç¤ºäº†å‡ºæ¥</p><p><img src="/../image/hummerRender/hierachy.png"></p><p><img src="/../image/hummerRender/result.png"></p><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Hummer çš„æ¸²æŸ“æœºåˆ¶è·Ÿ ReactNative çš„æ¯”è¾ƒåƒï¼š</p><p><img src="/../image/hummerRender/render.png"></p><p>ä¸è¿‡è¿˜æ˜¯æœ‰å¾ˆå¤šé—®é¢˜æµ®ç°äº†å‡ºæ¥ï¼š</p><ol><li>å¦‚æœç»„ä»¶å‘ç”Ÿäº†æ”¹å˜ï¼ŒHummer æ˜¯å¦‚ä½•åˆ·æ–°è§†å›¾æ ‘çš„å‘¢ï¼Ÿ</li><li>hummerCreate å‡½æ•°æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥ä» Hummer ä¾§è°ƒç”¨çš„å‘¢ï¼Ÿè¿˜æœ‰ render:ï¼Ÿï¼ˆè¯¦è§ <a href="https://wymann01.github.io/2022/09/05/Hummer%E7%9A%84%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/">Hummer é€šä¿¡æœºåˆ¶</a>ï¼‰</li><li>Native å’Œ JS æ˜¯å¦‚ä½•é€šä¿¡çš„ï¼Ÿ(<a href="https://wymann01.github.io/2022/09/05/Hummer%E7%9A%84%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/">Hummer çš„é€šä¿¡æœºåˆ¶</a>)</li><li>Hummer çš„å¯åŠ¨æµç¨‹éƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿï¼ˆå¯ä»¥åœ¨<a href="https://wymann01.github.io/2022/09/05/Hummer%E7%9A%84%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6/">è¿™ç¯‡æ–‡ç« </a>é‡Œäº†è§£ï¼‰</li></ol><p>è¿™äº›é—®é¢˜æˆ‘ä¼šåœ¨åç»­çš„æ–‡ç« ä¸­é€æ¸è¿›è¡Œè§£ç­”ã€‚</p><h3 id="è‡ªæµ‹ä¹ é¢˜"><a href="#è‡ªæµ‹ä¹ é¢˜" class="headerlink" title="è‡ªæµ‹ä¹ é¢˜"></a>è‡ªæµ‹ä¹ é¢˜</h3><p>æ ¹æ®ã€Šè®¤çŸ¥å¤©æ€§ã€‹ï¼Œè€ƒè¯•æ˜¯æœ€æœ‰æ•ˆçš„å­¦ä¹ ç­–ç•¥ä¹‹ä¸€ï¼Œä½ èƒ½è§£ç­”ä¸‹é¢çš„é—®é¢˜å—ï¼š</p><p><strong>ä¸ºä»€ä¹ˆä»¥ä¸‹å†™æ³•ä¸èƒ½ç”Ÿæ•ˆï¼Ÿ</strong></p><div class="code-wrapper"><pre><code class="hljs typescript">text.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = <span class="hljs-string">&#x27;#ffffff&#x27;</span></code></pre></div><p><img src="/../image/hummerRender/doubt.png"></p><p>ã€‚</p><p>ã€‚</p><p>ã€‚</p><p>ã€‚</p><p>è¯·è¯¸å›æ€è€ƒï¼Œæ€è€ƒ</p><p>ã€‚</p><p>ã€‚</p><p>ã€‚</p><p>è§£ç­”ï¼š<strong>é‚£ç§å†™æ³•ä¼šè°ƒç”¨ getter è€Œä¸æ˜¯ setterï¼Œä¹Ÿå°±æ˜¯hm_style: æ–¹æ³•ï¼Œè€Œä¸æ˜¯hm_setStyle: æ–¹æ³•ã€‚å½“ç„¶ä¸ä¼šç”Ÿæ•ˆã€‚</strong></p><hr><h3 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h3><ul><li>è·¨ç«¯æ¡†æ¶ Hummer é€šä¿¡æœºåˆ¶ - iOS ç‰ˆï¼ˆæ»´æ»´å†…éƒ¨èµ„æ–™ï¼‰</li><li><a href="https://juejin.cn/post/6844904003692658701#heading-9" title="ReactNative æºç è§£æ â€”â€” æ¸²æŸ“æœºåˆ¶è¯¦è§£">ReactNative æºç è§£æ â€”â€” æ¸²æŸ“æœºåˆ¶è¯¦è§£</a></li><li><a href="https://juejin.cn/post/6844904184542822408#heading-14" title="ã€ŒReactNative åŸç†ã€ Native å±‚çš„æ¸²æŸ“æµç¨‹">ã€ŒReactNative åŸç†ã€ Native å±‚çš„æ¸²æŸ“æµç¨‹</a></li><li><a href="https://www.jianshu.com/p/7e7b462c187b" title="è¯¦è§£ React Native æ¸²æŸ“åŸç†">è¯¦è§£ React Native æ¸²æŸ“åŸç†</a></li><li><a href="https://hummer.didi.cn/home#/" title="Hummer">Hummer</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¤§å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hummer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>performSelector è¯¦è§£â€”â€”ä» What åˆ° When</title>
    <link href="/2022/05/01/performSelector%20%E8%AF%A6%E8%A7%A3%E2%80%94%E2%80%94%E4%BB%8E%20What%20%E5%88%B0%20When/"/>
    <url>/2022/05/01/performSelector%20%E8%AF%A6%E8%A7%A3%E2%80%94%E2%80%94%E4%BB%8E%20What%20%E5%88%B0%20When/</url>
    
    <content type="html"><![CDATA[<h1 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h1><p>æˆ‘æœ€è¿‘è¢«ä¸€ä½é¢è¯•å®˜é—®ï¼š</p><ul><li><p><code>performSelector</code> æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ä» <code>runloop</code> çš„è§’åº¦è¯´è¯´ï¼Ÿ</p></li><li><p><code>performSelector</code> è·Ÿæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p></li></ul><p>ä¸€ä¸‹å­å°±æŠŠæˆ‘æè’™äº†ï¼Œè½¬å‹ iOS å¼€å‘åŠå¹´ï¼Œç¼–ç é‡å°‘ï¼Œè¿<code>performSelector</code> éƒ½æ²¡ç”¨è¿‡ï¼Œæœ€å¤šåœ¨é¡¹ç›®ä»£ç é‡Œè¯»åˆ°ï¼ŒåªçŸ¥é“å¤§æ¦‚æ˜¯å¹²å˜›çš„ï¼Œç°åœ¨é©¬ä¸Šæ¥ææ‡‚å®ƒï¼</p><h2 id="performSelector-æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ä»-runloop-çš„è§’åº¦è¯´è¯´ï¼Ÿ"><a href="#performSelector-æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ä»-runloop-çš„è§’åº¦è¯´è¯´ï¼Ÿ" class="headerlink" title="performSelector æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ä» runloop çš„è§’åº¦è¯´è¯´ï¼Ÿ"></a>performSelector æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æ–¹æ³•ï¼Œèƒ½ä¸èƒ½ä» runloop çš„è§’åº¦è¯´è¯´ï¼Ÿ</h2><blockquote><p>è¿™ä¸ªæ–¹æ³•çš„å…¥å‚æ˜¯ä¸€ä¸ª selectorï¼Œselector å±äº SELç±»å‹ï¼Œç”¨æ¥ä»£è¡¨ä¸€ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ª C çš„ stringã€‚æ‰“å°ä¸€ä¸ª selector ä¼šå¾—åˆ°å¯¹åº”æ–¹æ³•çš„åå­—ã€‚è¯¦è§<a href="https://developer.apple.com/documentation/objectivec/sel" title="å®˜æ–¹æ–‡æ¡£">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p></blockquote><p>è¿™é‡Œä»–è¦é—®çš„å…¶å®æ˜¯<code>performSelector:withObject:afterDelay</code> æ–¹æ³•ï¼ˆAppleæ–‡æ¡£åœ¨<a href="https://developer.apple.com/documentation/objectivec/nsobject/1416176-performselector/" title="è¿™é‡Œ">è¿™é‡Œ</a>ï¼‰ï¼Œåªæœ‰è¿™ä¸ªæ‰è·Ÿ runloop æœ‰å…³ç³»ã€‚è¿™ä¸ªæ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªå®šæ—¶å™¨Timerï¼Œå¹¶æŠŠå®ƒæ·»åŠ åˆ°å½“å‰çº¿ç¨‹çš„ Runloop ä¸Šï¼Œåˆ°äº†é¢„å®šæ—¶é—´å Runloop å¥½å»æ‰§è¡Œå¯¹åº”çš„ selector ï¼ˆå³æ‰§è¡Œæ–¹æ³•ï¼‰ã€‚</p><div class="code-wrapper"><pre><code class="hljs objective-c">+(void)performSelectorInMainThread &#123;    dispatch_async(dispatch_get_main_queue(), ^&#123;        [self performSelector:@selector(test) withObject:nil afterDelay:1.0];    &#125;);&#125;+(void)test &#123;    NSLog(@&quot;This is test method&quot;);&#125;</code></pre></div><p>æ³¨æ„ï¼šå¦‚æœæ˜¯åœ¨<strong>å­çº¿ç¨‹</strong>ä¸­è°ƒç”¨performSelector:withObject:afterDelay æ–¹æ³•ï¼Œé‚£å°±å¾—æ‰‹åŠ¨è·å–ä¸€ä¸‹ runloopï¼ŒåŒæ—¶å¾—è®©å­çº¿ç¨‹ä¸­çš„ runloop å¤„äº run çŠ¶æ€ã€‚<strong>å› ä¸ºå­çº¿ç¨‹ä¸­çš„ Runloop ä¸æ˜¯é»˜è®¤åˆ›å»ºï¼Œæ›´ä¸ä¼šé»˜è®¤ Run èµ·æ¥ã€‚</strong></p><div class="code-wrapper"><pre><code class="hljs objective-c">+(void)performSelectorInOtherThread &#123;    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;        NSLog(@&quot;1&quot;);        NSRunLoop *runloop = [NSRunLoop currentRunLoop]; // æ³¨é‡Šè¿™å¥,åˆ™ä¸ä¼šæ‰§è¡Œ test æ–¹æ³•        [self performSelector:@selector(test) withObject:nil afterDelay:1.0];        [runloop run];// æ³¨é‡Šè¿™å¥,ä¹Ÿä¸ä¼šæ‰§è¡Œ test æ–¹æ³•ï¼›         //åŒæ—¶ï¼Œè¿™å¥éœ€è¦æ”¾åœ¨ performSelector åé¢ï¼Œå¯¹åº”çš„ timer æ‰ä¼šè¢«æ·»åŠ åˆ° Runloop ä¸­        NSLog(@&quot;3&quot;);    &#125;);&#125;+(void)test &#123;    NSLog(@&quot;This is test method&quot;);&#125;</code></pre></div><blockquote><p>è¿™é‡Œå…¶å®ä¹Ÿå¯ä»¥å¼•ç”³ä¸¤ä¸ªé—®é¢˜ï¼š<br>1. å¦‚ä½•æŸ¥çœ‹Runloop æ‹¥æœ‰çš„ã€Œæºã€ï¼Ÿ<br>2. Runloop åœ¨ä»€ä¹ˆæ—¶å€™ä¼šé€€å‡ºï¼Ÿï¼ˆåœ¨æœ¬ç¤ºä¾‹ä»£ç ä¸­ï¼Œâ€œ3â€æ˜¯åœ¨ Runloopé€€å‡ºçš„æ—¶å€™æ‰“å°çš„ï¼Œé‚£ Runloop æ€ä¹ˆä¸ºå•¥ä¼šé€€å‡ºï¼Ÿï¼‰<br>æƒ³äº†è§£è¯¦æƒ…ï¼Œè¯·çœ‹<a href="https://juejin.cn/post/6844903781755256840" title="Runloop ä¸ performSelector">Runloop ä¸ performSelector</a></p></blockquote><h2 id="performSelector-è·Ÿæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#performSelector-è·Ÿæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="performSelector è·Ÿæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>performSelector è·Ÿæˆ‘ä»¬ç›´æ¥è°ƒç”¨ä¸€ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p><code>performSelector</code>æ˜¯è¿è¡Œæ—¶å†³è®®çš„ï¼Œç”¨<code>performSelector</code> å¯ä»¥åˆ°è¿è¡Œæ—¶æ‰å†³å®šè¦æ‰§è¡Œå“ªä¸ªæ–¹æ³•ï¼Œå› æ­¤ç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥ <code>performSelector</code>çš„å…¥å‚æ‰€ä»£è¡¨çš„<strong>æ–¹æ³•</strong>æ˜¯å¦å·²ç»è¢« <code>caller</code> å¯¹è±¡å®ç°ã€‚ï¼ˆå› æ­¤ï¼Œè¿™æ—¶ä½ å¯ä»¥åœ¨ã€Œä¸ import å¤´æ–‡ä»¶ã€çš„æƒ…å†µä¸‹è°ƒç”¨æ–¹æ³•ï¼‰</p><p>è€Œå¯¹äºä¸€èˆ¬çš„æ–¹æ³•è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¼šä¸¥æ ¼æŠŠæ§å½“å‰ caller æ˜¯å¦å®ç°äº†è¯¥æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ ¹æœ¬è¿‡ä¸äº†ç¼–è¯‘ã€‚</p><p>è¿™å°±ç±»ä¼¼äº Java è¯­è¨€ä¸­çš„ã€Œåå°„ã€æœºåˆ¶ã€‚</p><h2 id="performSelector-çš„ä½¿ç”¨"><a href="#performSelector-çš„ä½¿ç”¨" class="headerlink" title="performSelector çš„ä½¿ç”¨"></a>performSelector çš„ä½¿ç”¨</h2><p>å› ä¸ºå¯¹åº”çš„ selector æœ‰å¯èƒ½å®ç°ï¼Œä¹Ÿå¯èƒ½æ²¡å®ç°ï¼Œæ‰€ä»¥å®ƒå°å°è·Ÿ<code>respondsToSelector:</code> æ­é…ä½¿ç”¨ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p><div class="code-wrapper"><pre><code class="hljs objective-c">// æ£€æŸ¥ self å¯¹è±¡æ˜¯å¦å®ç°äº† test æ–¹æ³•if([self respondsToSelector:@selector(test)]) &#123;    [self performSelector:@selector(test)];&#125;</code></pre></div><p>å¦å¤–ï¼Œæ ¹æ® Apple çš„æ–‡æ¡£æè¿°ï¼ŒperformSelector å¯èƒ½ä¼šå¸¦æ¥å†…å­˜ç®¡ç†é—®é¢˜ï¼š</p><blockquote><p>But use caution when doing this. Different messages require different memory management strategies for their returned objects, and it might not be obvious which to use.<br>Usually the caller isnâ€™t responsible for the memory of a returned object, but thatâ€™s not true when the selector is one of the creation methods, such as <a href="https://developer.apple.com/documentation/objectivec/nsobject/1418807-copy" title="copy">copy</a>. See <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html#//apple_ref/doc/uid/20000994" title="Memory Management Policy">Memory Management Policy</a> in <a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html#//apple_ref/doc/uid/10000011i" title="Advanced Memory Management Programming Guide">Advanced Memory Management Programming Guide</a> for a description of ownership expectations. Depending on the structure of your code, it might not be clear which kind of selector you are using for any given invocation.<br>Due to this uncertainty, the compiler generates a warning if you supply a variable selector while using ARC to manage memory. Because it canâ€™t determine ownership of the returned object at compile-time, ARC makes the assumption that the caller does <em>not</em> need to take ownership, but this may not be true. The compiler warning alerts you to the potential for a memory leak.</p></blockquote><p>å¤§æ„æ˜¯ï¼Œå¦‚æœæä¾›çš„ selector æ˜¯æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¸¦æ¥æ‰€æœ‰æƒçš„ä¸ç¡®å®šï¼Œè¿›ä¸€æ­¥å¯¼è‡´<strong>å†…å­˜æ³„æ¼</strong>çš„é—®é¢˜ã€‚å¦‚æœç¡®å®š selector ä¸ä¼šè¿”å›å€¼ï¼Œå»ºè®®æ”¹ç”¨<a href="https://developer.apple.com/documentation/objectivec/nsobject/1414900-performselectoronmainthread" title="performSelectorOnMainThread:withObject:waitUntilDone:">performSelectorOnMainThread:withObject:waitUntilDone:</a> ã€‚ä¹Ÿå¯ä»¥æ”¹ç”¨ NSInvokationï¼Œæ„å»ºä¸€ä¸ªå¯ä»¥è¿”å›å€¼çš„ messageï¼ˆselector å¯ä»¥è¢«çœ‹åšæ˜¯ä¸€ä¸ª messageï¼Œå› ä¸º Objective-C è°ƒç”¨æ–¹æ³•çš„æ–¹å¼æ˜¯ã€Œæ¶ˆæ¯è½¬å‘ã€ï¼‰</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li><p>åŠ¨æ€åŒ–å’Œç»„ä»¶åŒ–</p></li><li><p>å¤šçº¿ç¨‹</p><div class="code-wrapper"><pre><code class="hljs objective-c">// ä¸»çº¿ç¨‹- (void)performSelectorOnMainThread:(SEL)aSelector withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array;// å­çº¿ç¨‹- (void)performSelector:(SEL)aSelector onThread:(NSThread *)thr withObject:(nullable id)arg waitUntilDone:(BOOL)wait modes:(nullable NSArray&lt;NSString *&gt; *)array</code></pre></div></li><li><p>å»¶åæ‰§è¡Œ</p><div class="code-wrapper"><pre><code class="hljs objective-c">[self performSelector:@selector(test) withObject:nil afterDelay:1.0];</code></pre></div></li></ul><hr><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><p><a href="https://developer.apple.com/documentation/objectivec/nsobject/1416176-performselector/" title="performSelector:withObject:afterDelay çš„æ–‡æ¡£">performSelector:withObject:afterDelay çš„æ–‡æ¡£</a></p></li><li><p><a href="https://juejin.cn/post/6844903781755256840" title="Runloop ä¸ performSelector">Runloop ä¸ performSelector</a>ï¼ˆRunloop é€€å‡ºæ—¶æœºï¼‰</p></li><li><p><a href="https://juejin.cn/post/6844903838550327304#heading-1" title="å…³äº performSelector çœ‹æˆ‘å°±å¤Ÿäº†">å…³äº performSelector çœ‹æˆ‘å°±å¤Ÿäº†</a>ï¼ˆä½¿ç”¨åœºæ™¯ï¼‰</p></li><li><p><a href="https://developer.apple.com/documentation/objectivec/1418956-nsobject/1418867-performselector/" title="performSelector å¯èƒ½å¯¼è‡´çš„å†…å­˜ç®¡ç†é—®é¢˜ï¼ˆApple æ–‡æ¡£ï¼‰">performSelector å¯èƒ½å¯¼è‡´çš„å†…å­˜ç®¡ç†é—®é¢˜ï¼ˆApple æ–‡æ¡£ï¼‰</a></p></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>é¢è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
